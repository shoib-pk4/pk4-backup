<html>
<head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
    <META NAME="Generator" CONTENT="ZeroCode version V42007.10.01 (Tomcat)">
    <link rel="stylesheet" href="/atCRM/stylesheets/entityView.css">
    <link rel="stylesheet" href="/atCRM/stylesheets/smartSuggest.css"/>
    <if eodAlert.usertheme.theme__deref.derefValue>
	<assign  eodAlerttheme=eodAlert.usertheme.theme__deref.derefValue>
    <else>
        <assign eodAlerttheme="green">
    </if>
    <link rel="stylesheet" href="/atCRM/stylesheets/JSON/${eodAlerttheme}/main.css"/>
    <META HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE"> 
    <title>Eod alert</title>
	<link rel="stylesheet" href="/atCRM/stylesheets/JSON/jquery/jquery.alerts.css"/>
    <link rel="stylesheet" href="/atCRM/stylesheets/JSON/general.css"/>
    <script src="/atCRM/javascript/JSON/jquery/jquery-1.6.2.js" type="text/javascript" ></script>
    <script type="text/javascript" src="/atCRM/javascript/JSON/jscal2.js"></script>
	<script type="text/javascript" src="/atCRM/javascript/JSON/en.js"></script>
    <script type="text/javascript" src="/atCRM/javascript/JSON/date-time-validation.js"></script>
    <script type="text/javascript" src="/atCRM/javascript/JSON/multiLvlPckList.js"></script>
    <script type="text/javascript" src="/atCRM/javascript/JSON/addEdit.js"></script>
    <script type="text/javascript" src="/atCRM/javascript/JSON/utils.js"></script>
    <script type="text/javascript" src="/atCRM/javascript/JSON/smartsuggestNew.js"></script>
    
</head>


<function emitSecureUrl (text, link)>
  <if link && link != "" && access_allowed (link)>
    <a href="${link}">${text}</a>
  <else>
    ${text}
  </if>
</function>


<script>
var date_format="dd/MM/yyyy";
var zcServletPrefix = "${servlet_prefix}";
var src = navigator.appName.indexOf ("Microsoft") >= 0 ? "calendar" : "calendar-moz";
document.write ('<script src="/atCRM/javascript/' + src + '.js"></scr' +
                'ipt>');
</script>

<script src="/atCRM/javascript/validate.js"></script>
<script src="/atCRM/javascript/descriptor.js"></script>
<script src="/atCRM/javascript/dateValidate.js"></script>

<script>
var calendar;
var isIE = document.all ? true : false;
var descriptors;


function buildDescriptors () {
    var form = document.mainForm ? document.mainForm : null;
    var descArray = new Array();
    var checkbox;
    

    return descArray;
}


function initialize () {
    var now = new Date ();
    var nowYear = now.getFullYear();
    var todaysDate = fmt (now.getMonth()+1) + "/" + fmt (now.getDate()) + "/" + nowYear;
    var timeNow = fmt (now.getHours()) + ":" + fmt (now.getMinutes()) + ":" + fmt(now.getSeconds());
    descriptors = buildDescriptors();
    for (var i = 0; i < descriptors.length; i++) {
        initializeTag (descriptors[i], todaysDate, timeNow);
    }
    calendar = new CalendarControl ('calendar');
	
	new Calendar({
		inputField: '0-401-406',
		dateFormat: "%d/%m/%Y", 
		trigger: "0-401-406_cal",
		bottomBar: true,
		fdow:0,
		min: 19000101,
		max: 29991231,
		align: "BL",
		onSelect: function() {this.hide();}
	});	
	new Calendar({
		inputField: '0-401-407',
		dateFormat: "%d/%m/%Y", 
		trigger: "0-401-407_cal",
		bottomBar: true,
		fdow:0,
		min: 19000101,
		max: 29991231,
		align: "BL",
		onSelect: function() {this.hide();}
	});	
	
	var pri_el = "${eodAlert.getUsrContDetails.pri_email}";
	var work_el = "${eodAlert.getUsrContDetails.work_email}";
	var home_el = "${eodAlert.getUsrContDetails.home_email}";
	
	if(pri_el == "" &&  work_el == "" && home_el == "")
	{
		document.getElementById("usrConatctDiv").style.display="block";
	}
	else
	{
		document.getElementById("eodAlertDiv").style.display="block";
		if(pri_el)
		{
			document.getElementById("toemail").innerHTML = "EOD Alert will be sent to &lt;"+pri_el+"&gt;";
		}
		else if(work_el)
		{
			document.getElementById("toemail").innerHTML = "EOD Alert will be sent to &lt;"+work_el+"&gt;";
		}
		else
		{
			document.getElementById("toemail").innerHTML = "EOD Alert will be sent to &lt;"+home_el+"&gt;";
		}
	}
}


function doValidate()
{	
	var errors="";
	var d1 = document.getElementById('0-401-406').value;
	var d2 = document.getElementById('0-401-407').value;
	var diff = MaxDate(d2,d1,"dd/MM/yyyy");
	if(!document.getElementById('0-401-403').value)
	{
		errors+="<li>Non-empty value needed for field 'Name'</li>";
		document.getElementById('0-401-403').focus();
	}

	if(!document.getElementById('0-401-404').value)
	{
		if(errors=="")
		document.getElementById('0-401-404').focus();
		errors+="<li>Non-empty value needed for field 'Description'</li>";
	}
	if(!document.getElementById('0-401-406').value)
	{
		if(errors=="")
		document.getElementById('0-401-406').focus();
		errors+="<li>Non-empty value needed for field 'Start On Date'</li>";
	}
	if(!document.getElementById('0-401-407').value)
	{
		if(errors=="")
		document.getElementById('0-401-407').focus();
		errors+="<li>Non-empty value needed for field 'End On Date'</li>";
	}	
	if(diff == 2 && document.getElementById('0-401-406').value && document.getElementById('0-401-407').value)
	{
		if(errors=="")
		document.getElementById('0-401-406').focus();
		errors+="<li>'End on date' should be gerater than 'Start on date'</li>";		
	}
	if(diff == 0 && document.getElementById('0-401-406').value && document.getElementById('0-401-407').value) 
	{
		if(errors=="")
		document.getElementById('0-401-406').focus();
		errors+="<li>'End on date' and 'Start on date' should not be same</li>";		
	}
	if(errors)
	{
		document.getElementById("errorDiv").style.display="block";
		document.getElementById("errorDiv").innerHTML="Please correct these errors. <br><br>"+errors;
		return false;
	}
	return true;
}
</script>


<script>
function doValidateEmails()
{
	var errorsmsg="";
	if(document.getElementById('0-401-552').value == "" &&  document.getElementById('0-401-466').value == "" &&  document.getElementById('0-401-636').value == "")
	{
		errorsmsg+="<li>Non-empty value needed for atleast one field</li>";
		document.getElementById('0-401-403').focus();
	}
	if(errorsmsg)
	{
		document.getElementById("errorDiv").style.display="block";
		document.getElementById("errorDiv").innerHTML="Please correct these errors. <br><br>"+errorsmsg;
		return false;
	}
	return true;	
}
function updateContact()
{
	document.getElementById('0-401-552').value=document.getElementById('0-401-552').value.trim();
	document.getElementById('0-401-466').value=document.getElementById('0-401-466').value.trim();
	document.getElementById('0-401-636').value=document.getElementById('0-401-636').value.trim();
	if (doValidateEmails()) 
	{
		document.getElementById("errorDiv").innerHTML="";
		document.getElementById("errorDiv").style.display="none";
		var action = zcServletPrefix+"/custom/JSON/add/Contact/editAction";
		var flds2Submit="";
		flds2Submit="0-401-402="+escape(document.getElementById("0-401-402").value)+"&0-401-552="+escape(document.getElementById("0-401-552").value)+"&0-401-466="+escape(document.getElementById("0-401-466").value)+"&0-401-636="+escape(document.getElementById("0-401-636").value)+"&display__mode=401,402,552,446,636";
       	$.ajax({
			type: "POST",
			url: action,
			data:flds2Submit,
			success: function ()
			{
				document.getElementById("usrConatctDiv").style.display="none";
				document.getElementById("eodAlertDiv").style.display="block";
			}
		});		
	}
}
function doUpdate (sts) {
	document.getElementById('0-401-403').value=document.getElementById('0-401-403').value.trim();
	document.getElementById('0-401-404').value=document.getElementById('0-401-404').value.trim();
    if (doValidate()) {
        document.mainForm.action = "${servlet_prefix}/custom/adhocReports/eodAlert/editAction";
		var msg = "EOD Alert Successfully "+sts;
        document.mainForm.submit();		
		parent.onEodSubmit(msg);
    }
}
function checkActive(eodchkboxid, eodinactiveid){
	if(document.getElementById(eodchkboxid).checked == true)
	{
		document.getElementById(eodinactiveid).value=0;
	}
	else
	{
		document.getElementById(eodinactiveid).value=1;
	}	
}
</script>

<script type="text/javascript">
  $(document).ready(function () {
   
    //add time combo
    var m = 'AM', opt;
    for(var i=1; i<= 24; i++) {
      if(i > 12)
        m = 'PM';
      opt = '<option value='+i+'>' + i + ' '+ m+ '</option>';
      //add option to select box
      $('#eodTime').append(opt);
    }


   $('#changeSendingToLink').click(function () {
       window["array_0_1_4202_multi"] = []; //fix for multiple select box
       var multipleSel = '<input type="hidden" name="0-1-4202" id="0-1-4202" class="reptParamsElem" value=""><input type="hidden" name="0-1-4202-multi" id="0-1-4202-multi" value=""><input type="hidden" name="0-1-4202-multi-max" id="0-1-4202-multi-max" value="5"><input type="hidden" name="0-1-4202-multi-fun" id="0-1-4202-multi-fun" value="">';
         multipleSel += '<input type="text" name="0-1-4202-multitxt" id="0-1-4202-multitxt" class="ui-corner-all multiSelectTxt" onkeyup="callAjax(\'multiSelectSugg\',this,event,\'/atCRM/custom/JSON/smartSuggest/genericPicklist.xml?pckListName=Account\',this.value,\'undefined\',\'undefined\');" onfocus="changeMultiTxt(this);" onblur="changeMultiTxt(this);" value="2 chars or **" autocomplete="off"/><div style="width:140px !important;" id="multiSelectSugg" name="multiSelectSugg" class="sf_suggestion" ></div>';
         multipleSel += '<div  class="multiSelectBox" name="0-1-4202-multi-multiSelDiv" id="0-1-4202-multi-multiSelDiv"></div>'; 

         $('#changeSendingTo').html(multipleSel);

   });

  });
</script>

<body class="PageBody" onLoad="initialize()">
  <div id="zc__errorDiv" style="color: red"></div>
  <div id="usrConatctDiv" style="display:none; vertical-align:middle" align="center">
  <input type="hidden" id="0-401-402" name="0-401-402" value="${eodAlert.getUsrContDetails.Contact_id}">
  <table width="100%" border="0" cellspacing="2" cellpadding="2">
  	  <tr>
        <td align="center" colspan="4" class="Default">&nbsp;</td>
      </tr> 
      <tr>
        <td align="center" colspan="4" class="Default"><strong>We could not find value in any of the below mentioned Email fields. Please key in your email id, we will send the EOD alerts to the same.</strong></td>
      </tr> 
      <tr>
        <td align="center" colspan="4" class="Default">&nbsp;</td>
      </tr>
      <tr>
      	<td width="10%">&nbsp;</td>
        <td valign="top" class="WhiteItemLabel">Primary email<font color="#FF0000"></font></td>
        <td><input type="text" class="inputFieldClass" maxlength="200" id="0-401-552" name="0-401-552"></td>
        <td width="10%">&nbsp;</td>
      </tr>  
       <tr>
        <td width="10%">&nbsp;</td>
        <td valign="top" class="WhiteItemLabel">Work email<font color="#FF0000"></font></td>
        <td><input type="text" class="inputFieldClass" maxlength="200" id="0-401-466" name="0-401-466">
        </td>
        <td width="10%">&nbsp;</td>
      </tr>   
      <tr>
        <td width="10%">&nbsp;</td>
        <td valign="top" class="WhiteItemLabel">Home email<font color="#FF0000"></font></td>
        <td><input type="text" class="inputFieldClass" maxlength="200"  id="0-401-636" name="0-401-636">
        </td>
        <td width="10%">&nbsp;</td>
      </tr>
      <tr>
        <td align="center" colspan="4" class="Default">&nbsp;</td>
      </tr>
      <tr>
      	<td width="10%">&nbsp;</td>
        <td colspan="2" align="center"><input type="button" onClick="updateContact()" value="Save" class="greenButton"></td>
        <td width="10%">&nbsp;</td>
      </tr>
  </table>
  </div>
  <div id="eodAlertDiv" style="display:none;">
  <form name="mainForm" method="post">
  <input name="response__uri" type="hidden" value="">
  <input type="hidden" value="${eodAlert.addEditEodAlert.wfw_comm_queue_id}" id="0-401-402" name="0-401-402">
  <input type="hidden" value="${eodAlert.getcont_where_clause}" id="0-401-405" name="0-401-405">
  <input type="hidden" value="Email" id="0-401-408" name="0-401-408">
  <input type="hidden" value="URL" id="0-401-409" name="0-401-409">
  <input type="hidden" value="${eodAlert.getTempltURL}" id="0-401-422" name="0-401-422">
  <input type="hidden" value="<if !eodAlert.addEditEodAlert.created_by >${eodAlert.getContactForSessionUsr.SBEUser}<else>${eodAlert.addEditEodAlert.created_by}</if>" id="0-401-434" name="0-401-434">
  <input type="hidden" value="<if eodAlert.addEditEodAlert.created_by >${eodAlert.getContactForSessionUsr.SBEUser}</if>" id="0-401-440" name="0-401-440">
  <input type="hidden" value="<if !eodAlert.addEditEodAlert.created_date >${eodAlert.getCurrentDtTime}<else>${eodAlert.addEditEodAlert.created_date}</if>" id="0-401-446" name="0-401-446">
  <input type="hidden" value="<if !eodAlert.addEditEodAlert.modified_date >${eodAlert.getCurrentDtTime}<else>${eodAlert.addEditEodAlert.modified_date}</if>" id="0-401-447" name="0-401-447">
  <input type="hidden" value="<if !eodAlert.addEditEodAlert.orgname >${eodAlert.getorgId}<else>${eodAlert.addEditEodAlert.orgname}</if>" id="0-401-448" name="0-401-448">
   <input type="hidden" value="24" id="0-401-424" name="0-401-424">
   <input type="hidden" value="Sent Daily Sales Report" id="0-401-423" name="0-401-423">  
  <input type="hidden" id="0-401-454" name="0-401-454" value="<if !eodAlert.addEditEodAlert.inactive || eodAlert.addEditEodAlert.inactive == 0 >0<else>${eodAlert.addEditEodAlert.inactive}</if>">  
	<table width="100%" border="0" cellspacing="2" cellpadding="2">
      <tr>
        <td align="center" colspan="3" class="Default"><strong><if !eodAlert.addEditEodAlert.wfw_comm_queue_id>Add<else>Edit</if> EOD Alert</strong></td>
      </tr> 
      <tr>
        <td align="center" colspan="3" class="Default">${eodAlert.getreportName.name}</td>
      </tr>
      <tr>
        <td align="center" colspan="3" class="Default" id="toemail"></td>
      </tr>
	  <tr>
        <td align="left" colspan="3"><div style="font-size: 11px;padding-top: 5px;padding-bottom: 5px;" align="justify" wrap="">Setup will help you to get End Of Day alerts.</div></td>
      </tr>
      <tr>
        <td valign="top" class="WhiteItemLabel">Name<font color="#FF0000">*</font></td>
        <td colspan="2"><input type="text" class="inputFieldClass" value="${eodAlert.addEditEodAlert.wfw_name}" id="0-401-403" name="0-401-403"></td>
      </tr>  
       <tr>
        <td valign="top" class="WhiteItemLabel">Description<font color="#FF0000">*</font></td>
        <td colspan="2"><textarea id="0-401-404" class="inputFieldClass" name="0-401-404" cols="50" rows="2">${eodAlert.addEditEodAlert.wfw_description}</textarea>
        </td>
      </tr>   
      <tr>
        <td> To </td>
        <td></td>
        <td id='changeSendingTo'> 
            Me
              <a href='#' id='changeSendingToLink'> Change </a>
        </td>
      </tr>
      <tr>
        <td valign="top" class="WhiteItemLabel">Start On Date<font color="#FF0000">*</font></td>
        <td colspan="2">     
        <input type="text" class="inputFieldClass" value="<if !eodAlert.addEditEodAlert.start_send_from >${eodAlert.getCurrentDtTime}<else>${eodAlert.addEditEodAlert.start_send_from}</if>" id="0-401-406" name="0-401-406" size=12 maxlength=12  onblur="changeDate('0-401-406');" style="width: 80px;"><img src='/atCRM/images/calendar.gif' id='0-401-406_cal' alt='Pick Date' style='cursor:pointer;vertical-align:middle;padding-left:1px;'/>
        </td>
      </tr>
      <tr>
        <td valign="top" class="WhiteItemLabel">End On Date<font color="#FF0000">*</font></td>
        <td colspan="2">            
        <input type="text" class="inputFieldClass" value="<if !eodAlert.addEditEodAlert.end_send_after >${eodAlert.getCurrentDtTimePlusYear}<else>${eodAlert.addEditEodAlert.end_send_after}</if>" id="0-401-407" name="0-401-407" size=12 maxlength=12 onBlur="changeDate('0-401-407');" style="width: 80px;"><img src='/atCRM/images/calendar.gif' id='0-401-407_cal' alt='Pick Date' style='cursor:pointer;vertical-align:middle;padding-left:1px;'/>
        </td>
      </tr>
      <tr>
        <td valign="top" class="WhiteItemLabel">Frequency</td>
        <td colspan="2">
          <select id="eodTime"> 

          </select>
      <select id="0-401-431" name="0-401-431" style="width:40%;">         
            <option value="Every-Day" <if eodAlert.addEditEodAlert.comm_freq == "Every-Day">selected="selected"</if>>Every day</option>
            <option value="Sun" <if eodAlert.addEditEodAlert.comm_freq == "Sunday">selected="selected"</if>>Sunday</option>
            <option value="Mon" <if eodAlert.addEditEodAlert.comm_freq == "Monday">selected="selected"</if>>Monday</option>
            <option value="Tue" <if eodAlert.addEditEodAlert.comm_freq == "Tuesday">selected="selected"</if>>Tuesday</option>
            <option value="Wed" <if eodAlert.addEditEodAlert.comm_freq == "Wednesday">selected="selected"</if>>Wednesday</option>
            <option value="Thu" <if eodAlert.addEditEodAlert.comm_freq == "Thursday">selected="selected"</if>>Thursday</option>
            <option value="Fri" <if eodAlert.addEditEodAlert.comm_freq == "Friday">selected="selected"</if>>Friday</option>
            <option value="Sat" <if eodAlert.addEditEodAlert.comm_freq == "Saturday">selected="selected"</if>>Saturday</option>
            <option value="1st-of-Mth" <if eodAlert.addEditEodAlert.comm_freq == "1st-of-Mth">selected="selected"</if>>1st of every month</option>
            <option value="15th-of-Mth" <if eodAlert.addEditEodAlert.comm_freq == "15th-of-Mth">selected="selected"</if>>15th of every month</option>
            <option value="Every-Year" <if eodAlert.addEditEodAlert.comm_freq == "Every-Year">selected="selected"</if>>Every year</option>
            <option value="Every-Quarter" <if eodAlert.addEditEodAlert.comm_freq == "Every-Quarter">selected="selected"</if>>Every quarter</option>
         </select>
        </td>
      </tr>
      <tr>
        <td valign="top" class="WhiteItemLabel">Attachment</td>
        <td colspan="2">
        <select id="0-401-433" name="0-401-433" style="width:40%;">
            <option value="Inline" <if eodAlert.addEditEodAlert.attachment_type == "Inline">selected="selected"</if>>Inline</option>
            <option value="Excel" <if eodAlert.addEditEodAlert.attachment_type == "Excel">selected="selected"</if>>M-Excel</option>           
         </select></td>
      </tr>
      <tr>
        <td valign="top" class="WhiteItemLabel">Active</td>
        <td align="left"><input id="eodinactive" name="eodinactive" type="checkbox" onChange="checkActive('eodinactive','0-401-454');" <if !eodAlert.addEditEodAlert.inactive || eodAlert.addEditEodAlert.inactive == 0 >checked="checked"</if>></td>
        <td><input type="button" value="<if !eodAlert.addEditEodAlert.wfw_comm_queue_id>Add<else>Edit</if>" onClick="doUpdate('<if !eodAlert.addEditEodAlert.wfw_comm_queue_id>Added<else>Edited</if>')" class="greenButton" style="margin-left:280px;"></td>
      </tr>      
    </table>
</form>
	</div>
<div id="errorDiv" style="color: red;background:#F2F0FF;border:1px solid #D8D2FF;padding:5px;display:none;width:450px;font:10px;text-align:left;margin-top:5px;"></div>
</body>
</html>



<!-- zeroCode ::: V42007.10.01 (Tomcat) ::: betterSample/customTemplate.html ::: 02-Feb-2011 03:56:26 PST ::: -->

