		<html>
		<head>
		  <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
		  <META NAME="Generator" CONTENT="ZeroCode version V3.2B2003.08.13">
		  <link rel="stylesheet" href="/atCRM/stylesheets/sbe.css">
		  <link rel="stylesheet" href="/atCRM/stylesheets/enhancedSample.css">
		  <link rel="stylesheet" href="/atCRM/stylesheets/entityView.css">
		  <META HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE">
		  <title>Account home</title>
		</head>

<style>
.NormalViewClass
{
	font-size: 12px;
    font-family: Tahoma;
    font-weight: normal;
	color: black;
}
.OnOverViewClass
{
	font-size: 12px;
	font-family: Tahoma;
    font-weight: normal;
	color: black;	
	background-color: #FDDF99;
	cursor: pointer;
    cursor: hand;
}

</style>
<assign displayString = ext__.evaluateUdm ("custom/find/getOrgPref","custom/adminNew/AdminSetUp")>

<function emitLangString (text)><transform blankLineRemover>
<assign strlist = displayString.getOrgPref.findstring.findEntries ("base_string", text)>
<if strlist>
<assign counter="0">
<list strlist as l1>
<if counter == "0">
<assign counter="1">
${l1.disp_string}
</if>
</list>
<else>
${text}
</if>
</transform></function>


		<script>
		var date_format="${displayString.getOrgPref.ReadDateFormat.dateFormat}";
		var appName = navigator.appName;
		var src = appName.indexOf ("Microsoft") >= 0 ? "calendar" : "calendar-moz";
		document.write ('<script src="/atCRM/javascript/' + src + '.js"></scr' +
		              'ipt>');
		</script>

		<script src="/atCRM/javascript/validate.js"></script>
		<script src="/atCRM/javascript/descriptor.js">
		</script>


		<script>
		var monthAbbrevs = new Array ("Jan", "Feb", "Mar", "Apr", "May", "Jun",
		                            "Jul", "Aug", "Sep", "Oct", "Nov", "Dec");
		var calendar;
		var isIE = document.all ? true : false;
		var descriptors;


		function buildDescriptors () {
		  var form = document.mainForm ? document.mainForm : null;
		  var descArray = new Array();
		  var checkbox;
			    
		  return descArray;
		}


		function initialize () {
		  var now = new Date ();
		  var nowYear = isIE ? now.getYear() : (now.getYear() + 1900);
		  // Netscape returns 1900+year for getYear
		  var todaysDate = fmt (now.getMonth()+1) + "/" + fmt (now.getDate()) + "/" +
		      nowYear;
		  var timeNow = 
		      fmt (now.getHours()) + ":" + fmt (now.getMinutes()) + ":" +
		      fmt(now.getSeconds());
		  descriptors = buildDescriptors();
		  for (var i = 0; i < descriptors.length; i++) {
		      initializeTag (descriptors[i], todaysDate, timeNow);
		  }

		  calendar = new CalendarControl ('calendar');
		  
		  var emailError = getQueryParameter("emailError");
		  if(emailError == 1)
		  {
			  document.getElementById("emailError").style.display="block";
			  document.getElementById("emailError").innerHTML = "Error: Invalid Email username and password.";
		  }
		  if(emailError == 2)
		  {
			  document.getElementById("emailError").style.display="block";
			  document.getElementById("emailError").innerHTML = "Error: Invalid Email Server Configuration.";
		  }
		}

		function fmt(x) {
		  x = "" + x; // Convert to string
		  return (x.length > 1) ? x : ("0" + x);
		}


		var invalidFields = null;
		function validate () {

		  var msg = "";

		  // First, restore the state of any fields that were previously found invalid.
		  if (invalidFields && invalidFields.length) {
		      for (var i = 0; i < invalidFields.length; i++) {
		          invalidFields[i].className = "inputFieldClass";
		      }
		  }

		  // Now check all the fields.
		  invalidFields = new Array();
		  for (var i = 0, count = 0; i < descriptors.length; i++) {
		      var result = null;
		      try {
		          result = verifyValidity (descriptors[i]);
		      } catch (e) {
		          alert ("Validation exception for '" + descriptors[i].description +
		                 "' (" + descriptors[i].tagName + ")");
		          return false;
		      }
		      if (result) {
		          count++;
		          msg += "\n<li>" + result.message + "</li>";
		          if (result.field) {
		              result.field.className = "invalidInputFieldClass";
		              invalidFields[invalidFields.length] = result.field;
		              if (count == 1) result.field.focus();
		          }
		      }
		  }
		  var errorDiv = document.getElementById ("zc__errorDiv");
		  if (msg != "") {
		      msg = "Invalid input:\n" +
		          "<ul type=1>\n" + msg + "\n</ul>Please correct these errors.";
		      if (errorDiv) {
		          errorDiv.innerHTML = msg;
		      } else {
		          alert (msg);
		      }
		      return false;
		  }

		  if (errorDiv && errorDiv.innerHTML != "") {
		      errorDiv.innerHTML = "";
		  }
		  return true;
		}


		function checkAll (id) {
		  var form = document.mainForm;
		  var controlBox = form.elements ("chkAll-" + id);
		  var value = controlBox.checked;
		  var n = form.elements.length;
		  for (var i = 0; i < n; i++) {
		      var x = form.elements [i];
		      var xName = x.name;
		      var suffix = xName.substring (xName.length - id.length - 1);
		      if (suffix == "-" + id && x.type == "checkbox" ) {
		          x.checked = value;
		      }
		  }
		}


		function chkAll (id) {
		  var n = document.mainForm ? document.mainForm.elements.length : 0;
		  if (n <= 0) {
		      return;
		  }
		  var form = document.mainForm;
		  var controlBox = form.elements ("chkAll-" + id);
		  var value = controlBox.checked;
		  for (var i = 0; i < n; i++) {
		      var x = document.mainForm.elements [i];
		      var xName = x.name;
		      if (xName == "chk-" + id && x.type == "checkbox" ) {
		          x.checked = value;
		      }
		  }
		}

		</script>


		<function emitSecureUrl (text, link)>
		<if access_allowed (link)><a href="${servlet_prefix}/${link}">${text}</a><else>${text}</if>
		</function>


		<script src="/atCRM/javascript/pagination.js">
		</script>


		<script>
		var recordNumber = -1;

		function showNextRecord () {
		  if (recordNumber < 0) {
		      recordNumber = eval ("<if accountHome.RecentItems__listCtl.thisPage>(${accountHome.RecentItems__listCtl.thisPage} - 1) * ${accountHome.RecentItems__listCtl.pagingAmount}<else>0</if>");
		  }
		  document.write (++recordNumber);
		}


		function doSort () {
		  var form = document.mainForm;
		  var isIE = document.all ? true : false;
		  var sortSelector = isIE ? form("sortSelector") : form ["sortSelector"];
		  var sortId = sortSelector.options[sortSelector.selectedIndex].value;
		  var searchId = "${search__id}";
		  var href = "${servlet_prefix}/custom/accountHome.html?order__by__1=" + sortId;
		  if (searchId != "") {
		      href += "&search__id=" + searchId;
		  }
		  window.location.href = href;
		}

		function emitSortingArrow (columnNodeId, derefNodeId, columnNodeDesc) {
		  var count = parseInt ("${accountHome.RecentItems__listCtl.count}");
		  if (isNaN(count) || count == 0) return;
		  var result = "";
		  var searchId = "${search__id}";
		  var orderByField = "${accountHome.RecentItems__listCtl.orderBy}";
		  var sortKeyId = derefNodeId != "" ? derefNodeId : columnNodeId;
			    
		  var queryString = "${thisUdmsQueryString}";
		  var params = queryString.split ('&');
		  var displayMode = "";
		  for (var i = 0; i < params.length; i++) {
		      if (params[i].substring (0, 13) == "display__mode") {
		          displayMode = "&" + params[i];
		          break;
		      }
		  }

		  if (orderByField == sortKeyId ||
		      isPrefix (orderByField, sortKeyId + ",") ||
		      isSuffix (orderByField, "," + sortKeyId)) {
		      result = '<a href="${servlet_prefix}/custom/accountHome.html?' +
		          (searchId != '' ? ('search__id=' + searchId + '&') : '') +
		          'order__by__1=-' + sortKeyId + displayMode + '" border=0>' +
		          '<img src="/atCRM/images/arrow_dwn.gif" border=0 ' +
		          'alt="Sort descending, by ' + columnNodeDesc + '"></a>';
		  } else if (orderByField == ('-' + sortKeyId) ||
		      isPrefix (orderByField, '-' + sortKeyId + ",") ||
		      isSuffix (orderByField, ",-" + sortKeyId)) {
		      result = '<a href="${servlet_prefix}/custom/accountHome.html?' +
		          (searchId != '' ? ('search__id=' + searchId + '&') : '') +
		          'order__by__1=' + sortKeyId + displayMode + '" border=0>' +
		          '<img src="/atCRM/images/arrow_up.gif" border=0 ' +
		          'alt="Sort ascending, by ' + columnNodeDesc + '"></a>';
		  }  else {
		      result = '<a href="${servlet_prefix}/custom/accountHome.html?' +
		          (searchId != '' ? ('search__id=' + searchId + '&') : '') +
		          'order__by__1=' + sortKeyId + displayMode + '" border=0>' +
		          '<img src="/atCRM/images/arrow_rt.gif" border=0 ' +
		          'alt="Sort ascending, by ' + columnNodeDesc + '"></a>';
		  }
		  document.write (result);
		}


		function isPrefix (s1, s2) { // Is s2 a prefix of s1?
		  return s1.substring (0, s2.length) == s2;
		}

		function isSuffix (s1, s2) { // Is s2 a suffix of s1?
		  return s1.substring (s1.length - s2.length) == s2;
		}


		function generationhref (page_number) {
		  var strval = "${servlet_prefix}/custom/accountHome.html?" +
		      "search__id=${search__id}" +
		      "&paging__node=1" +
		      "&page__number=" + page_number +
		      "&order__by__1=${accountHome.RecentItems__listCtl.orderBy}";
		  var queryString = "${thisUdmsQueryString}";
		  var params = queryString.split ('&');
		  for (var i = 0; i < params.length; i++) {
		      if (params[i].substring (0, 13) == "display__mode") {
		          strval += "&" + params[i];
		          break;
		      }
		  }
		  return strval;
		}

		function emitPagingRibbon() {
		  var pageNumber="${accountHome.RecentItems__listCtl.thisPage}";
		  var linkCount="${accountHome.RecentItems__listCtl.pageList.size}";
		  if (linkCount > 1) {
		      paging (linkCount, pageNumber, "atCRM");
		  }
		}
		</script>
		<script>
		function doAdd () {
		  window.location.href="${servlet_prefix}/custom/add/accountHome.html";
		}

		function doSearch () {
		  window.location.href="${servlet_prefix}/custom/search/accountHome.html";
		}
		function getReports()
		{
		var getreportQuery= document.getElementById("select1").options[document.getElementById("select1").options.selectedIndex].value;
		window.location.href="${servlet_prefix}/"+ getreportQuery;

		}
		function loadSummary(){
		document.getElementById("summarySection").className =  "tabSelect";
		document.getElementById("detailsSection").className =  "tabDeselect";
		window.location.href="${servlet_prefix}/custom/accountHome.html"
		}

		function loadDetails(){
		//document.getElementById("summarySection").className =  "tabDeselect";
		//document.getElementById("detailsSection").className =  "tabDeselect";
		window.location.href="${servlet_prefix}/custom/AccountDetail.html?id=1&order__by__1=2";
		}

		function setDefMenu()
		{
			var url="${servlet_prefix}/custom/adminNew/def_menu_item_for_user.html";
			window.open(url,"","width=500,height=280,toolbar=no,menubar=no,location=no, directories=no,status=yes,scrollbars=yes,resize=no");
		}

		function tabIconOnOverView(id)
		{
			document.getElementById(id).className="OnOverViewClass";
		}

		function tabIconNormalView(id)
		{
			document.getElementById(id).className="NormalViewClass";
		}
		function updateProfile()
		{
			window.location.href = "${servlet_prefix}/custom/adminNew/editContactDetails.html?id=${AdminSetUp.getLnkUsrContRec.Contact}&backto=${servlet_prefix}/custom/adminNew/AdminSetUp.html"
		}
		function updateMenuOrder()
		{
			window.location.href = "${servlet_prefix}/custom/adminNew/getMenusForWizard.html";
		}
		function updateTheme()
		{
			window.location.href = "${servlet_prefix}/custom/JSON/ThemeSelection.html";
		}
		</script>

		<body bgcolor="white" onLoad="initialize()">
		  <form name="mainForm" method="post" action="${servlet_prefix}/custom/accountHome/editAction" >
		  <input type="hidden" name="0-101-103" value="${AdminSetUp.getLnkUsrContRec.Contact}">
			<table bgcolor="white" border="0" bordercolor="green" width="100%" cellspacing="0" cellpadding="0">
		  		<tr class="clsHeader">
					<td height="20">My Profile </td>
				</tr>
			</table>
		  			<BR><BR>                    
			<div align="center" style="border:0 px;padding-left:75px" >
            <div id="emailError" style="text-align:left; width:45%; color:#930; border: #930 none 1px; display:none; font-weight:bold;"></div>
            <br>
				<TABLE width="80%" border=1 cellspacing="0" cellpadding="3" align="center">
					<TR>
						<td class="default">
						<A HREF="javascript:updateProfile();">Update profile</A>
						</td>
						<TD class="default" id="updateProfile" name="updateProfile" >
						This screen will allow you to update your profile. You can change your name, your address, mobile number, email ID, whom you report to in the organization, etc. You can also change your password from this page.
						</TD>
					</TR>
					<TR>
						<td class="default">
						<A HREF="javascript:setDefMenu();">Update default Menu item</A>
						</td>
						<TD class="default" id="menuOrder" name="menuOrder" >This screen will allow you to update the default menu item that is highlighted when you log into Impel. For example, if you are mostly working with Accounts in Impel, you can make the Accounts tab your default choice. So when you log in, that will be the tab that will be shown first.</TD>
					</TR>
					<TR>
						<td class="default">
						<A HREF="javascript:updateMenuOrder();">Update Menu structure</A>
						</td>
						<TD class="default" id="menuStructure" name="menuStructure" >This screen will allow you to update your menu structure. You can rename tabs or reorder them. If, say, you are more comfortable with the word "People" in your menu for the "Contacts" tab, you can rename it right here. <!-- And you can add your own web-page addresses, too - for example, you can add your own iGoogle page as a sub-tab in Impel. --></TD>
					</TR><!-- 
					<TR>
						<td class="default">
						<A HREF="javascript:updateTheme();">Select theme</A>
						</td>
						<TD class="default" id="ThemeS" name="ThemeS" >This screen will allow you to select a theme or to change your existing theme from a list of themes provided.
						Listed thumbnails shows you the particular theme display in a browser. To apply any one theme from the list click on that particular thumbnail. Themes are applicable only on Web2O UI.
						</TD>
					</TR> -->
				</TABLE>
			</div>
		  </form>
		</body>