<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <title> Workflow for CRM </title>
  <meta name="Generator" content="EditPlus">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
	<link rel="stylesheet" href="/atCRM/stylesheets/JSON/Jquery_Blue/jquery.ui.all.css"/>
	<link rel="stylesheet" href="/atCRM/stylesheets/JSON/green/main.css"/>
	<link rel="stylesheet" href="/atCRM/stylesheets/JSON/green/quickAdd.css"/>
	<link rel="stylesheet" href="/atCRM/stylesheets/smartSuggest.css"/>
	<link rel="stylesheet" type="text/css" href="/atCRM/stylesheets/jquery.dataTables.css"/>

	<link rel="stylesheet" type="text/css" href="/atCRM/stylesheets/jquery.dataTables.css"/>
	<link rel="stylesheet" type="text/css" href="/atCRM/stylesheets/pivot/bootstrap.min.css"/>
	<link rel="stylesheet" type="text/css" href="/atCRM/stylesheets/pivot/pivot.css"/>
	<link rel="stylesheet" type="text/css" href="/atCRM/stylesheets/TableTools.css"/>
	<link rel="stylesheet" type="text/css" href="/atCRM/stylesheets/TableTools_JUI.css"/>
	<link rel="stylesheet" type="text/css" href="/atCRM/stylesheets/style_h/jquery-ui-1.8.21.custom.css"/>
	<link rel="stylesheet" href="/atCRM/stylesheets/JSON/green/jquery.css"/>
	<link rel="stylesheet" href="/atCRM/stylesheets/JSON/general.css"/>

	<link rel="stylesheet" href="/atCRM/stylesheets/JSON/green/flexigrid.css"/>
	<link rel="stylesheet" href="/atCRM/stylesheets/JSON/green/fly.css"/>
	<link href="/atCRM/javascript/fckeditor/sample.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="/atCRM/stylesheets/JSON/general.css"/>
    <link rel="stylesheet" href="/atCRM/stylesheets/JSON/universal.css"/>

	<script type="text/javascript" src="/atCRM/javascript/JSON/quickAddPopup.js"></script>
	<script type="text/javascript" src="/atCRM/javascript/JSON/pickList.js" ></script> 
	<script type="text/javascript" src="/atCRM/javascript/JSON/multiLvlPckList.js"></script>
	
	<script type="text/javascript" src="/atCRM/javascript/JSON/addEdit.js"></script>
	<script type="text/javascript" src="/atCRM/javascript/JSON/utils.js"></script>
	<script type="text/javascript" src="/atCRM/javascript/JSON/smartsuggestNew.js"></script>
	<script type="text/javascript" src="/atCRM/javascript/JSON/commonElementFunction.js"></script>
	<script type="text/javascript" src="/atCRM/javascript/JSON/jquery/jquery-1.6.2.js"></script>
	<script type="text/javascript" src="/atCRM/javascript/cjquery.js"></script>
	<script type="text/javascript" src="/atCRM/javascript/JSON/jquery/jquery.effects.core.js"></script>
	<script type="text/javascript" src="/atCRM/javascript/JSON/jquery/jquery.effects.slide.js"></script>

    <script type="text/javascript">

		//Saving the Rule_Action...
	function Sav_Rule(ActionRuleSavd){	
		if(document.getElementById('txt_Rule_Name').value == ''){
			 var disp1 = document.getElementById('div_Err');
			 disp1.className = 'DisplayLabelClass';
			 disp1.style.backgroundColor = '#FFDC77';
			 disp1.style.visibility = 'visible';
			 disp1.innerHTML = 'Please enter all the required fields to save the Rule';
			 setTimeout("document.getElementById('div_Err').style.visibility='hidden'",3000);
			 return false;
		}
		else if(document.getElementById('select_Rule_on_Obj').value == ''){
			 var disp2 = document.getElementById('div_Err');
			 disp2.className = 'DisplayLabelClass';
			 disp2.style.visibility = 'visible'; 
			 disp2.innerHTML = 'Please select an object to trigger the action on';
			 setTimeout("document.getElementById('div_Err').style.visibility='hidden'",3000);
			 return false;
		}
		/*else if(document.getElementById('txtarea_Trig_Cond').value == ''){
			 var disp3 = document.getElementById('div_Err');
			 disp3.className = 'DisplayLabelClass';
			 disp3.style.backgroundColor = '#FFDC77';
			 disp3.style.visibility = 'visible';
			 disp3.innerHTML = 'Please enter the Triggering Condition to save the Rule';
			 setTimeout("document.getElementById('div_Err').style.visibility='hidden'",3000);
			 return false;
		}*/
		if(document.getElementById('work_flow_id').value==""){
			 var check_res = document.getElementById('CheckRuleActvStatus');
			 if(check_res.checked)
			 check_res = '0';
			 else
			 check_res = '1';
        }
		var url2AddRule;
		var flowId=document.getElementById('work_flow_id').value;
		if(flowId||flowId!='false'||flowId!=false){
			url2AddRule='/atCRM/custom/JSON/add/addWfwRule/editAction?0-1-2='+document.getElementById('work_flow_id').value+'&0-1-3='+document.getElementById('txt_Rule_Name').value+'&0-1-4='+document.getElementById('txtarea_Description').value+'&0-1-5='+document.getElementById('select_Rule_on_Obj').value+'&0-1-6='+document.getElementById('SelectRuleOnEvnt').value+'&0-1-7=1&0-1-8=trigger&0-1-9=ddd&0-1-31=1';
		}
		else{
			url2AddRule='/atCRM/custom/JSON/add/addWfwRule/editAction?0-1-3='+document.getElementById('txt_Rule_Name').value+'&0-1-4='+document.getElementById('txtarea_Description').value+'&0-1-30='+check_res+'&0-1-5='+document.getElementById('select_Rule_on_Obj').value+'&0-1-6='+document.getElementById('SelectRuleOnEvnt').value+'&0-1-7=1&0-1-8=trigger&0-1-9=ddd&0-1-31=1';}
				$.ajax({
					type: "GET",
					url:url2AddRule,
					dataType: "json",
					success: function (doc){	
						document.getElementById('work_flow_id').value = doc['addedId'];
						//Calling Sav2Edit for Rule...
						sav2edit(document.getElementById('work_flow_id').value,1);
						if(ActionRuleSavd == 0)
						AddAction();
					}
				});
			document.getElementById('action_div').style.display = 'inline';
		}
		
	var RRActionId;
	//Saving the Round_Robin Action..
	var Edt_Load = 0; //Glbl Var used to Disp the Updated label in Actions..
	function rr_sav_Action(){
		if(RRActionId)
		var url2RRActionRule = '/atCRM/custom/JSON/add/addWfwAction/editAction?0-1-2='+RRActionId+'&0-1-3='+document.getElementById('work_flow_id').value+'&0-1-9=1&0-1-10=0&0-1-13=rr&0-1-87='+document.getElementById('txtArea_RR_Hist_CSV').value+'&0-1-88='+document.getElementById('txtArea_RR_SQL').value+'&0-1-89='+document.getElementById('RR_L_assign_rec_txtBox').value+'&0-1-90=aaa&0-1-91=27/7/2010 12:00:00&0-1-112=0';
		else
		var url2RRActionRule = '/atCRM/custom/JSON/add/addWfwAction/editAction?0-1-3='+document.getElementById('work_flow_id').value+'&0-1-9=1&0-1-10=0&0-1-13=rr&0-1-87='+document.getElementById('txtArea_RR_Hist_CSV').value+'&0-1-88='+document.getElementById('txtArea_RR_SQL').value+'&0-1-89='+document.getElementById('RR_L_assign_rec_txtBox').value+'&0-1-90=aaa&0-1-91=27/7/2010 12:00:00&0-1-112=0';
			$.ajax({
				type: 'POST',
				url: url2RRActionRule,
				dataType: 'json',
				success: function(doc){
					RRActionId = doc['addedId'];
					RR_Action_Sav2View(RRActionId);
					list_display(document.getElementById('work_flow_id').value);
				}
			});
	}
			
//Sav2Edit Part for Round-Robin Action...
var rr_entt_column;
var rr_last_assigned_at;
var rr_last_assigned_to;
var rr_history_csv;
var rr_candidate_sql;
var rr_last_assigned_rec_id;
	//Sav2Edit Part for Round-Robin Action...
	function RR_Action_Sav2View(RRActionId){	
		var url2View = '/atCRM/custom/JSON/view/wfw_action360View.json?id='+RRActionId;
			$.ajax({
				type: 'GET',
				url: url2View,
				dataType: 'JSON',
				success: function(doc){
					rr_entt_column = doc['rr_entt_column'];
					rr_last_assigned_at = doc['rr_last_assigned_at'];
					rr_last_assigned_to = doc['rr_last_assigned_to'];
					rr_history_csv = doc['rr_history_csv'];
					rr_candidate_sql = doc['rr_candidate_sql'];
					rr_last_assigned_rec_id = doc['rr_last_assigned_rec_id'];
					round_robin_div(0);
				}
			});
	}
		
var CTaskActionId;
	//Saving Create Task Action..
	function Ctask_Action_save(){
		if(CTaskActionId)
			var url2CTActionRule = '/atCRM/custom/JSON/add/addWfwAction/editAction?0-1-2='+CTaskActionId+'&0-1-3='+document.getElementById('work_flow_id').value+'&0-1-9=1&0-1-10=0&0-1-13=t&0-1-42='+document.getElementById('select_C_T_assign_type').value+'&0-1-49='+document.getElementById('Ctask_Subject_txt').value+'&0-1-50='+document.getElementById('txtArea_Ctask_Not').value+'&0-1-51='+document.getElementById('select_C_T_strt_offset').value+'&0-1-52='+document.getElementById('select_C_T_offset_hrs').value+'&0-1-112=0&0-1-74='+document.getElementById('select_C_T_task_typ').value+'&0-1-80='+document.getElementById('select_C_T_task_status').value;
		else
			var url2CTActionRule = '/atCRM/custom/JSON/add/addWfwAction/editAction?0-1-3='+document.getElementById('work_flow_id').value+'&0-1-9=1&0-1-10=0&0-1-13=t&0-1-42='+document.getElementById('select_C_T_assign_type').value+'&0-1-49='+document.getElementById('Ctask_Subject_txt').value+'&0-1-50='+document.getElementById('txtArea_Ctask_Not').value+'&0-1-51='+document.getElementById('select_C_T_strt_offset').value+'&0-1-52='+document.getElementById('select_C_T_offset_hrs').value+'&0-1-112=0&0-1-74='+document.getElementById('select_C_T_task_typ').value+'&0-1-80='+document.getElementById('select_C_T_task_status').value; 
				$.ajax({
					type: "GET",
					url:url2CTActionRule,
					dataType: 'JSON',
					success: function (doc){
						CTaskActionId = doc['addedId'];
						CTask_Sav2View(CTaskActionId);
						list_display(document.getElementById('work_flow_id').value);
					}
				});
	}

var CT_assign_type;
var CT_subject;
var CT_notes;
var CT_start_offset_from;
var CT_start_offset_hrs;
var CT_actvt_type;
var CT_actvt_status;
	//Sav2View part of Create Task Action...
	function CTask_Sav2View(CTaskActionId){
		var url2View = '/atCRM/custom/JSON/view/wfw_action360View.json?id='+CTaskActionId;
			$.ajax({
				type: 'GET',
				url: url2View,
				dataType: 'JSON',
				success: function(doc){
					CT_assign_type = doc['t_assign_type'];
					CT_subject = doc['t_subject'];
					CT_notes = doc['t_notes'];
					CT_start_offset_from = doc['t_start_offset_from'];
					CT_start_offset_hrs = doc['t_start_offset_hrs'];
					CT_actvt_type = doc['t_actvt_type'];
					CT_actvt_status = doc['t_actvt_status'];
					Create_task(0);
				}
			});
	}
				
	//Getting Values one after the other using , for the Send mail Action...
	function getAllSelected(selectId){
		var oSelect=document.getElementById(selectId);
		var chosen = "";
			for (var iCount=0; oSelect.options[iCount]; iCount++){
				if (oSelect.options[iCount].selected == true){
					if(chosen)
						chosen = chosen + "," + oSelect.options[iCount].value;
					else
						chosen = oSelect.options[iCount].value;
				}
			}
		return chosen;
	}

var MailActionId;
	//Saving the Send Mail Action...
	function mail_Action_save(){
		var StrVal1 =  getAllSelected('select_send_mail_to');
		var StrVal2 =  getAllSelected('select_copy_mail');
		
		if(MailActionId)
			var url2MailActionRule = "/atCRM/custom/JSON/add/addWfwAction/editAction?0-1-2="+MailActionId+"&0-1-3="+document.getElementById('work_flow_id').value+"&0-1-9=1&0-1-10=0&0-1-13=e&0-1-26="+document.getElementById('txtBox_Email_Subj').value+"&0-1-27=aaa&0-1-28="+StrVal1+"&0-1-29="+document.getElementById('txt_snd_speci_ppl').value+"&0-1-30="+StrVal2+"&0-1-31="+document.getElementById('txt_cpy_mail2ppl').value+'&0-1-112=0';
		else
			var url2MailActionRule = "/atCRM/custom/JSON/add/addWfwAction/editAction?0-1-3="+document.getElementById('work_flow_id').value+"&0-1-9=1&0-1-10=0&0-1-13=e&0-1-26="+document.getElementById('txtBox_Email_Subj').value+"&0-1-27=aaa&0-1-28="+StrVal1+"&0-1-29="+document.getElementById('txt_snd_speci_ppl').value+"&0-1-30="+StrVal2+"&0-1-31="+document.getElementById('txt_cpy_mail2ppl').value+'&0-1-112=0';
				$.ajax({
					type: 'GET',
					url: url2MailActionRule,
					dataType: 'JSON',
					success: function(doc){
						MailActionId = doc['addedId'];
						Mail_Sav2View(MailActionId);
						list_display(document.getElementById('work_flow_id').value);
					}
				});
	}

var e_templt;
var e_subject;
var e_send_to_types;
var e_send_to_conts_csv;
var e_cc_to_types;
var e_cc_to_conts_csv;
	//Save2View part of Send Mail Action...
	function Mail_Sav2View(MailActionId){
		var url2View = '/atCRM/custom/JSON/view/wfw_action360View.json?id='+MailActionId;
			$.ajax({
				type: 'GET',
				url: url2View,
				dataType: 'JSON',
				success: function(doc){	
					e_templt = doc['e_templt'];	
					e_subject = doc['e_subject'];
					e_send_to_types = doc['e_send_to_types'];
					e_send_to_conts_csv = doc['e_send_to_conts_csv'];
					e_cc_to_types = doc['e_cc_to_types'];
					e_cc_to_conts_csv = doc['e_cc_to_conts_csv'];
				}
			});
	}

var SmsActionId;					
	//Saving the Send SMS Action...
	function Sms_Action_save(){
		if(SmsActionId)
			var url2SmsActionRule = "/atCRM/custom/JSON/add/addWfwAction/editAction?0-1-2="+SmsActionId+"&0-1-3="+document.getElementById('work_flow_id').value+"&0-1-9=1&0-1-10=0&0-1-13=s&0-1-39="+document.getElementById('txtArea_sms2sent').value+"&0-1-40="+document.getElementById('select_send_sms').value+"&0-1-41="+document.getElementById('txt_send_sms_ppl').value+'&0-1-112=0';
		else
			var url2SmsActionRule = "/atCRM/custom/JSON/add/addWfwAction/editAction?0-1-3="+document.getElementById('work_flow_id').value+"&0-1-9=1&0-1-10=0&0-1-13=s&0-1-39="+document.getElementById('txtArea_sms2sent').value+"&0-1-40="+document.getElementById('select_send_sms').value+"&0-1-41="+document.getElementById('txt_send_sms_ppl').value+'&0-1-112=0';
				$.ajax({
					type: 'GET',
					url: url2SmsActionRule,
					dataType: 'json',
					success: function(doc){
						SmsActionId = doc['addedId'];
						Sms_Sav2View(SmsActionId);
						list_display(document.getElementById('work_flow_id').value);
					}
				});
	}

var s_mesg;
var s_send_to_types;
var s_send_to_conts_csv;
	//Save2view Part of Send SMS Action...
	function Sms_Sav2View(SmsActionId){
		var url2View = '/atCRM/custom/JSON/view/wfw_action360View.json?id='+SmsActionId;
			$.ajax({
				type: 'GET',
				url: url2View,
				dataType: 'json',
				success: function(doc){	
					s_mesg = doc['s_mesg'];
					s_send_to_types = doc['s_send_to_types'];
					s_send_to_conts_csv = doc['s_send_to_conts_csv'];
				}
			});
	}

var UpdtActionId;
	//Saving the Update Action...
	function Update_Action_save(){
		if(UpdtActionId)
			var url2UpdateActionRule = "/atCRM/custom/JSON/add/addWfwAction/editAction?0-1-2="+UpdtActionId+"&0-1-3="+document.getElementById('work_flow_id').value+"&0-1-9=1&0-1-10=0&0-1-13=u&0-1-71="+document.getElementById('txt_col2updt').value+"&0-1-78="+document.getElementById('txt_tbl2updt').value+"&0-1-79="+document.getElementById('txtArea_formula2updt').value+'&0-1-112=0';
		else
			var url2UpdateActionRule = "/atCRM/custom/JSON/add/addWfwAction/editAction?0-1-3="+document.getElementById('work_flow_id').value+"&0-1-9=1&0-1-10=0&0-1-13=u&0-1-71="+document.getElementById('txt_col2updt').value+"&0-1-78="+document.getElementById('txt_tbl2updt').value+"&0-1-79="+document.getElementById('txtArea_formula2updt').value+'&0-1-112=0';
				$.ajax({
					type: 'GET',
					dataType: 'json',
					url: url2UpdateActionRule,
					success: function(doc){
						UpdtActionId = doc['addedId'];
						Updt_Sav2View(UpdtActionId);
						list_display(document.getElementById('work_flow_id').value);
					}
				});
	}

var u_col_to_update;
var u_col_to_upd_name;
var u_tbl_to_update;
var u_tbl_to_upd_name;
var u_formula;
	//Save2View of Update Action...
	function Updt_Sav2View(Updt_Action_id){
		var url2View = '/atCRM/custom/JSON/view/wfw_action360View.json?id='+Updt_Action_id;
			$.ajax({
				type: 'GET',
				url: url2View,
				dataType: 'JSON',
				success: function(doc){
					u_col_to_update = doc['u_col_to_update'];
					u_col_to_upd_name = doc['u_col_to_upd_name'];
					u_tbl_to_update = doc['u_tbl_to_update'];
					u_tbl_to_upd_name = doc['u_tbl_to_upd_name'];
					u_formula = doc['u_formula'];
					update(0);
				}
			});
	}

	//Function that show transformation from Edit phase to Save phase...
	function Edit2Sav(){
		var TxtboxRuleName = document.getElementById('txt_Rule_Name');
		TxtboxRuleName.style.display = 'inline';
		LblRuleName = document.getElementById('label_Rule_Name');
		TxtboxRuleName.value = LblRuleName.innerHTML;
		LblRuleName.style.display = 'none';
		
		var SelectedRuleOnObjVal = document.getElementById('LblDisplyRuleOnObjct');
		SelectedRuleOnObjVal.style.display = 'none';
		var SelectRuleOnObj = document.getElementById('select_Rule_on_Obj');
		SelectRuleOnObj.style.display = 'inline';
		for(var k=0;k<SelectRuleOnObj.length;k++){
			if(SelectRuleOnObj[k].text == SelectedRuleOnObjVal.innerHTML){
				SelectRuleOnObj[k].selected = true;
				break;
			}
		}

		var SelectedRuleOnEvnt = document.getElementById('LblDisplyRuleOnEvnt');
		SelectedRuleOnEvnt.style.display = 'none';
		var SelectRuleOnEvnt = document.getElementById('SelectRuleOnEvnt');
		SelectRuleOnEvnt.style.display = 'inline';
		for(var l=0;l<SelectRuleOnEvnt.length;l++){
			if(SelectRuleOnEvnt[l].text == SelectedRuleOnEvnt.innerHTML){
				SelectRuleOnEvnt[l].selected = true;
				break;
			}
		}

		var TxtAreaRuleDesc = document.getElementById('txtarea_Description');
		TxtAreaRuleDesc.style.display = 'inline';
		LblRuleDesc = document.getElementById('label_Description');
		TxtAreaRuleDesc.value = LblRuleDesc.innerHTML;
		LblRuleDesc.style.display = 'none';

		document.getElementById('Rul_Trig_Cond_td').style.display = 'inline-table';
		//var R_bac5 = document.getElementById('txtarea_Trig_Cond');
		//R_bac5.style.display = 'inline';
		//R_bac_lab5 = document.getElementById('Lbl_Disp_Trig_Cond');
		//R_bac5.value = R_bac_lab5.innerHTML;
		//R_bac_lab5.style.display = 'none';

		var RuleButton = document.getElementById('Add_Rule_Sav');
		RuleButton.value = 'Update';
		RuleButton.setAttribute('onclick','Sav_Rule()');

		document.getElementById('rule_disp_label').style.visibility = 'hidden';
		document.getElementById('Rule_Nm_Status_td').style.visibility = 'visible';
		document.getElementById('Rule_Nm_Actv_td').style.display = 'inline';
		document.getElementById('CheckRuleActvStatusTd').style.visibility = 'visible';
		document.getElementById('RuleActvDispTd').style.visibility = 'visible';	
		document.getElementById('DispRuleActvTd').style.display = 'inline';
		document.getElementById('TdEditModeActvDisply').style.display = 'none';
	}
			
	//Save2Edit part of Rule...
	var count;
	function sav2edit(Param_passed_Id,IdLoaded){	
		var url2edit = '/atCRM/custom/JSON/view/wfw_rule360View.json?id='+Param_passed_Id;
			$.ajax({
				type: 'GET',
				url: url2edit,
				dataType: 'JSON',
				async:false,
				success: function(doc){	
					var doc_data = doc['TopPanel'];
					var data = new Array();
					for(var i=0;i<doc_data.length;i++){
						var data = doc_data[i]['dataColumn'];

						if(data[0] == "Name"){
							var s1hide1 = document.getElementById('txt_Rule_Name');
							s1hide1.style.display = 'none';
							var s1R_namelab = document.getElementById('label_Rule_Name');
							s1R_namelab.style.display = 'inline';
							s1R_namelab.style.fontWeight = 'bold';
							if(data[1] == ''){
								s1R_namelab.innerHTML = 'Value Not Defined';
								document.getElementById('action_div').style.display = 'none';
							}
							else{ 
								s1R_namelab.innerHTML = data[1];							
								document.getElementById('action_div').style.display = 'block';
							}
						}

						if(data[0] == 'Rule on Object'){
							var SelectRuleOnObj = document.getElementById('select_Rule_on_Obj');
							//alert(SelectRuleOnObj.length);
							SelectRuleOnObj.style.display = 'none';
							var s1Trig_Val_lab1 = document.getElementById('LblDisplyRuleOnObjct');
							s1Trig_Val_lab1.style.display = 'inline';
							s1Trig_Val_lab1.style.fontWeight = 'bold';
							if(data[1] == '')
							s1Trig_Val_lab1.innerHTML = 'Value Not Defined';
							else{
								data[1]=data[1].trim();
								for(var m=0;m<SelectRuleOnObj.length;m++){
									if(SelectRuleOnObj[m].value==data[1]){
										var SelectRuleOnObjTxt = SelectRuleOnObj.options[m].text;
										break;
									}
								}
							s1Trig_Val_lab1.innerHTML = SelectRuleOnObjTxt;
							}
							var s1span1 = document.getElementById('SpanSelectRuleOnObject');
							s1span1.appendChild(s1Trig_Val_lab1);
						}

						if(data[0] == 'On Event'){
							var SelectOnEvnt = document.getElementById('SelectRuleOnEvnt');
							SelectOnEvnt.style.display = 'none';
							var s1Trig_Val_lab2 = document.getElementById('LblDisplyRuleOnEvnt');
							s1Trig_Val_lab2.style.display = 'inline';
							s1Trig_Val_lab2.style.fontWeight = 'bold';
							if(data[1] == '')
							s1Trig_Val_lab2.innerHTML = 'Value Not Defined';
							else{
								data[1]=data[1].trim();
								for(i=0;i<SelectOnEvnt.length;i++){
									if(SelectOnEvnt[i].value==data[1]){
										var SelectOnEvntTxt = SelectOnEvnt.options[i].text;
										//break;
									}
								}
								s1Trig_Val_lab2.innerHTML = SelectOnEvntTxt;
							}
							var s1span2 = document.getElementById('SpanSelectOnEvnt');
							s1span2.appendChild(s1Trig_Val_lab2);
						}

						if(data[0] == 'Description'){
							var s1hide4 = document.getElementById('txtarea_Description');
							s1hide4.style.display = 'none';
							var s1_Desc_lab = document.getElementById('label_Description');
							s1_Desc_lab.style.display = 'inline';
							s1_Desc_lab.style.fontWeight = 'bold'
							if(data[1] == '')
							s1_Desc_lab.innerHTML = 'Value Not Defined';
							else
							s1_Desc_lab.innerHTML = data[1];
						}

						if(data[0] == 'Filter'){
							//var s1hide5 = document.getElementById('txtarea_Trig_Cond');
							//s1hide5.style.display = 'none';
							var s1txtarea2 = document.getElementById('Rul_Trig_Cond_td');
							s1txtarea2.style.display = 'none';
							//var s1Trig_Cond_lab = document.getElementById('Lbl_Disp_Trig_Cond');
							//s1Trig_Cond_lab.style.display = 'inline';
							//s1Trig_Cond_lab.innerHTML = data[1];
							//s1Trig_Cond_lab.style.fontWeight = 'bold';
							//s1txtarea2.appendChild(s1Trig_Cond_lab);
						}
					}
				if(IdLoaded!=0){
					var rule_disp_label = document.getElementById('rule_disp_label');
					rule_disp_label.style.visibility = 'visible';
					rule_disp_label.style.backgroundColor = '#FFDC77';
				}
				if(count&&IdLoaded!=0){
					rule_disp_label.innerHTML = 'Rule has been updated.';
					setTimeout("document.getElementById('rule_disp_label').style.visibility='hidden'",2000);
				}
				else if(IdLoaded!=0){
					rule_disp_label.innerHTML = 'Rule has been added.';
					setTimeout("document.getElementById('rule_disp_label').style.visibility='hidden'",2000);
				}
				var s1button = document.getElementById('Add_Rule_Sav');
				s1button.value = 'Edit';
				s1button.setAttribute('onclick','Edit2Sav()');
				document.getElementById('Rule_Nm_Status_td').style.visibility = 'visible';
				document.getElementById('Rule_Nm_Actv_td').style.display = 'inline';
				document.getElementById('CheckRuleActvStatusTd').style.visibility = 'hidden';
				document.getElementById('RuleActvDispTd').style.visibility = 'hidden';
				var labelhide = document.getElementById('DispRuleActvTd');
				labelhide.style.display = 'none';
				var disp_label = document.getElementById('TdEditModeActvDisply');
				disp_label.innerHTML = 'This Rule is Active';
				disp_label.className = 'normal_font';
				if(document.getElementById('CheckRuleActvStatus').checked)
				disp_label.style.display = 'inline';
				else
				disp_label.style.display = 'none';
				count=1;
			}
		});
	}
		
	//Lists the Table of Actions for the Required Rule...
	function list_display(List_tableId){	
		var url2list = '/atCRM/custom/JSON/list/wfw_action.json?wr='+List_tableId;
			$.ajax({
				type: 'GET',
				url: url2list,
				dataType: "json",
				success: function(doc){	
					var list_div_attach = document.getElementById('list_div');
					list_div_attach.innerHTML = '';
				//Creation of Table...
					var list_table = CreateTable(list_div_attach);
					list_table.style.borderCollapse = 'collapse';
					list_table.style.width = '90%';
				//Creation of TR...
					var list_div_tr1 = CreateTR(list_table);
					var ColmHdr = doc['ColumnHeaders'];
					var ColmVal = doc['RowData'];
					var Req_Rw_data = new Array();
					var td_data = new Array();
					var table_tr = new Array();
					var li_table_td = new Array();
				
				for(var i=0;i<ColmVal.length;i++){
					var table_tr = CreateTR(list_table);
					var Req_Rw_data = doc['RowData'][i];
					var Req_data = Req_Rw_data['data'];
                    var actionType;
						for(var j=0;j<Req_data.length;j++){
							var td_value = Req_data[j]['colTxt'];
							//Creation of 1st TD...
							if(j==0){
								var SeqTdHdr = CreateTD(table_tr,'ItemLabelView normal_font');
								SeqTdHdr.innerHTML = ColmHdr[0]['colmnDesc'];
								var SeqTdVal = CreateTD(table_tr,'normal_font');
								SeqTdVal.innerHTML = td_value;
								SeqTdVal.style.fontWeight = 'bold';
							}
							else if(j==1)
							{
							    var ActTypTdHdr = CreateTD(table_tr,'ItemLabelView normal_font');
								ActTypTdHdr.innerHTML = ColmHdr[j]['colmnDesc'];
								var actnTdVal = CreateTD(table_tr,'normal_font');
								actnTdVal.style.fontWeight = 'bold';
								actionType = td_value;
							}
							else{
							    var headerTxt=ColmHdr[j]['colmnDesc'];
								//headerTxt=headerTxt.toLowerCase();
                                if(actionType == "t"){
								actnTdVal.innerHTML = 'Create Task';
									if(headerTxt.indexOf("Task")>-1){        //Depending upon the Action type Header Value and its corresponding Td Value is Displayed...
										var tskHdr=CreateTD(table_tr,'ItemLabelView normal_font');
										tskHdr.innerHTML = headerTxt;
										var taskTdVal = CreateTD(table_tr,'normal_font');
										taskTdVal.innerHTML = td_value;
										taskTdVal.style.fontWeight = 'bold';
									}
								}

								if(actionType == "rr"){
								actnTdVal.innerHTML = 'Round Robin';
									if(headerTxt.indexOf("Round")>-1){
										var RoundRobinHdr=CreateTD(table_tr,'ItemLabelView normal_font');
										RoundRobinHdr.innerHTML=headerTxt;
										var RRTdVal = CreateTD(table_tr,'normal_font');
										RRTdVal.innerHTML = td_value;
										RRTdVal.colSpan = '3';
										RRTdVal.style.fontWeight = 'bold';
									}
								}

								if(actionType == "e"){
								actnTdVal.innerHTML = 'Send Email';
									if(headerTxt.indexOf("Email")>-1){
										var MailHdr = CreateTD(table_tr,'ItemLabelView normal_font');
										MailHdr.innerHTML = headerTxt;
										var MailVal = CreateTD(table_tr,'normal_font');
										MailVal.innerHTML = td_value;
										MailVal.style.fontWeight = 'bold';
									}
								}

								if(actionType == "s"){
								actnTdVal.innerHTML = 'Send SMS';
									if(headerTxt.indexOf("SMS")>-1){
										var SMSHdr = CreateTD(table_tr,'ItemLabelView normal_font');
										SMSHdr.innerHTML = headerTxt;
										var SMSVal = CreateTD(table_tr,'normal_font');
										SMSVal.innerHTML = td_value;
										SMSVal.style.fontWeight = 'bold';
									}
								}

								if(actionType == "u"){
								actnTdVal.innerHTML = 'Update';
									if(headerTxt.indexOf("Update")>-1){
										var UpdtHdr = CreateTD(table_tr,'ItemLabelView normal_font');
										UpdtHdr.innerHTML = headerTxt;
										var UpdtVal = CreateTD(table_tr,'normal_font');
										UpdtVal.innerHTML = td_value;
										UpdtVal.style.fontWeight = 'bold';
									}
								}
							}
						}
						var EditTd = CreateTD(table_tr);
						var EditLabel = CreateLABEL(EditTd,'EditActionClass normal_font','EditActionLbl','Edit');
						if(actionType == 'rr')
						EditLabel.setAttribute("onclick","RR_Action_Sav2View(\""+RRActionId+"\")");
						else if(actionType == 't')
						EditLabel.setAttribute("onclick","javascript:alert('CreateTask');");
						else if(actionType == 'e')
						EditLabel.setAttribute("onclick","javascript:send_mail();");
						else if(actionType == 's')
						EditLabel.setAttribute("onclick","javascript:alert('Send SMS');");
						else if(actionType == 'u')
						EditLabel.setAttribute("onclick","Updt_Sav2View(\""+UpdtActionId+"\")");
					}
				}
			});
	}
			
	//Function to Check the "Rule is Active" Label Display...
	function checked(){
		document.getElementById("CheckRuleActvStatus").checked = "true";
		var label1 = document.getElementById('DispRuleActvTd');
		label1.innerHTML = "The Rule is Active";
	}
			
	//Function to Change the Bg-Color on Focus...
	function focus_change_color(id){
		document.getElementById(id).style.backgroundColor = '#F8FBEE';
		document.getElementById(id).style.border = '1px solid #ADCF54';
	}
			
	//Function to Change the BG-Color on Blur...
	function blur_change_color(id){
		document.getElementById(id).style.backgroundColor = '#FFFFFF';
		document.getElementById(id).style.border = '1px solid #CCCCCC';
	}

	//Function to check the Inactive...
	function Active_check(id){	
		var test_active = document.getElementById(id);
		var label1 = document.getElementById('DispRuleActvTd');
		if(test_active.checked)
		label1.innerHTML = "The Rule is Active";
		else
		label1.innerHTML = " ";
	}
			
	//Function to Get the Objects for the Select Box for Different Actions...
	function get_objects(entity,selbox_id){
		url2Hit =  "/atCRM/custom/JSON/smartSuggest/dropDownDataForView.json?entity="+entity;
			$.ajax({
				type: "GET",
				url:url2Hit,
				dataType: "json",
				async:false,
				success: function (pckDoc){
					var dataArray=pckDoc['PickListItems'].listData;		
					var selectBox = document.getElementById(selbox_id);
					for(var i=0; i<dataArray.length; i++){	
						val=dataArray[i].columnData.split('~)');
						selectBox[i]=new Option(val[1], val[0]);
					}
					selectBox[0].selected = true;
				}
			});
	}
			
	//Adding the Rule.. If there is no parameter passed in URL..
	function Add_rule(){	
		//var Param_passed_Id = getQueryParameter ("id");
		var Param_passed_Id = "${ext__.parameter.id}";
		var AddRuleDiv1 = document.getElementById('AddRuleDiv');
		//AddRuleDiv1.style.border = '1px solid #DDD';
		AddRuleDiv1.innerHTML += "<table width='90%'><tr><td width='50%' class='normal_font' align='left'>Set up the rule with a Name and triggering conditions.</td><td width='50%' class='MandatoryClass' align='right'>* Required Field(s)&nbsp;&nbsp;&nbsp;&nbsp;</td></tr></table>";
		AddRuleDiv1.innerHTML += '<br/>';
		//Creation of Table...
			var Add_Rule_table = CreateTable(AddRuleDiv1);
			//Add_Rule_table.style.width = '90%';
			Add_Rule_table.cellPadding="5";
			//TR_1...
				var Add_Rule_tr1 = CreateTR(Add_Rule_table);
				var Rule_Nm_td1 = CreateTD(Add_Rule_tr1,'ItemLabelView');
				// NM: Rule_Nm_td1.style.height = '54px';
				Rule_Nm_td1.style.width = '10%';
				var Rule_Nm_span1 = CreateSPAN(Rule_Nm_td1,'','','Rule Name');
				var Rule_Nm_span2 = CreateSPAN(Rule_Nm_td1);
				Rule_Nm_span2.style.color = 'blue';	
				Rule_Nm_span2.style.fontSize = '12px';
				Rule_Nm_span2.innerHTML = '&nbsp;*';
				var Rule_Nm_td2 = CreateTD(Add_Rule_tr1);
				Rule_Nm_td2.style.width = '40%';
				var Rule_Name_txt_box = CreateTEXTBOX(Rule_Nm_td2,'','txt_Rule_Name');
				Rule_Name_txt_box.style.height = 'none';
				// Rule_Name_txt_box.style.width = '385px';
				Rule_Name_txt_box.setAttribute('onfocus','focus_change_color(this.id)');
				Rule_Name_txt_box.setAttribute('onblur','blur_change_color(this.id)');
				var Rule_Name_Disp_label1 = CreateLABEL(Rule_Nm_td2,'normal_font','label_Rule_Name');
				Rule_Name_Disp_label1.style.display = 'none';
				var Rule_Nm_td3 = CreateTD(Add_Rule_tr1,'ItemLabelView','Rule_Nm_Status_td','','left','Status');
				Rule_Nm_td3.style.width = '15%';
				Rule_Nm_td3.style.visibility = 'visible';
				var Rule_Nm_td4 = CreateTD(Add_Rule_tr1,'','Rule_Nm_Actv_td');
				Rule_Nm_td4.style.width = '30%';
				Rule_Nm_td4.innerHTML += "<table><tr><td id='CheckRuleActvStatusTd'><input type='checkbox' id='CheckRuleActvStatus' onchange='Active_check(this.id)' /></td><td id='RuleActvDispTd'>&nbsp;Active&nbsp;</td><td id='DispRuleActvTd' class='normal_font' style='color:blue'></td><td id='TdEditModeActvDisply' style='display:none;'></td></tr></table>";
			//TR2...
				var Add_Rule_tr2 = CreateTR(Add_Rule_table);
				var Rule_Trig_td7 = CreateTD(Add_Rule_tr2,'ItemLabelView');
				// NM: Rule_Trig_td7.style.height = '54px';
				var Rule_Trig_span6 = CreateSPAN(Rule_Trig_td7,'','','Rule Triggered');
				var Rule_Trig_span7 = CreateSPAN(Rule_Trig_td7,'','','*');
				Rule_Trig_span7.style.color = 'blue';	
				Rule_Trig_span7.style.fontSize = '12px';
				Rule_Trig_span7.innerHTML = '&nbsp;*';
				var Rule_Trig_td8 = CreateTD(Add_Rule_tr2);
				Rule_Trig_td8.style.width = '20%';
				var Rule_Trig_span8 = CreateSPAN(Rule_Trig_td8,'','','When&nbsp;');
				var Rule_Trig_span9 = CreateSPAN(Rule_Trig_td8,'','SpanSelectRuleOnObject');
				var Select_Rule_on_Obj = CreateSelectBox(Rule_Trig_span9,'','select_Rule_on_Obj');
				Select_Rule_on_Obj.setAttribute('onfocus','focus_change_color(this.id)');
				Select_Rule_on_Obj.setAttribute('onblur','blur_change_color(this.id)');
				var sel_opt_none = CreateOptionBox(Select_Rule_on_Obj,'','','','None');
				var sel_opt_Acc = CreateOptionBox(Select_Rule_on_Obj,'','','account','Account');
				var sel_opt_Acty = CreateOptionBox(Select_Rule_on_Obj,'','','activity','Activity');
				var sel_opt_Coll = CreateOptionBox(Select_Rule_on_Obj,'','','collection','Collection');
				var sel_opt_Cont = CreateOptionBox(Select_Rule_on_Obj,'','','contact','Contact');
				var sel_opt_Exp = CreateOptionBox(Select_Rule_on_Obj,'','','expense','Expense');
				var sel_opt_IVH = CreateOptionBox(Select_Rule_on_Obj,'','','invoice_header','Invoice_Header');
				var sel_opt_LPM = 
				CreateOptionBox(Select_Rule_on_Obj,'','','loy_pgm_mbr','Loy_Program_Member');
				var sel_opt_LPX = 
				CreateOptionBox(Select_Rule_on_Obj,'','','loy_pgm_xn','Loy_Program_Xn');
				var sel_opt_Oppt = CreateOptionBox(Select_Rule_on_Obj,'','','opportunity','Opportunity');
				var sel_opt_QH = CreateOptionBox(Select_Rule_on_Obj,'','','quote_header','Quote_Header');
				var sel_opt_Tic = CreateOptionBox(Select_Rule_on_Obj,'','','ticket','Ticket');
				Select_Rule_on_Obj.style.width = '150px';
				var Lbl_Rul_on_Obj = CreateLABEL(Rule_Trig_span6,'','LblDisplyRuleOnObjct');
				Lbl_Rul_on_Obj.style.display = 'none';
				var Rule_Trig_span10 = CreateSPAN(Rule_Trig_td8,'','','&nbsp;record is&nbsp;');
				var Rule_Trig_span11 = CreateSPAN(Rule_Trig_td8,'','SpanSelectOnEvnt');
				var Sel_on_Evnt = CreateSelectBox(Rule_Trig_span11,'','SelectRuleOnEvnt');
				Sel_on_Evnt.setAttribute('onfocus','focus_change_color(this.id)');
				Sel_on_Evnt.setAttribute('onblur','blur_change_color(this.id)');
				Sel_on_Evnt.style.width = '150px';
				var sel_opt_AoE = CreateOptionBox(Sel_on_Evnt,'','bas_opt_val1','INSERT or UPDATE','Added or Edited');
				var sel_opt_add = CreateOptionBox(Sel_on_Evnt,'','bas_opt_val2','INSERT','Added');
				var sel_opt_Edit = CreateOptionBox(Sel_on_Evnt,'','bas_opt_val3','UPDATE','Edited');
				var LblDisplyRuleOnEvnt = CreateLABEL(Rule_Trig_span10,'normal_font','LblDisplyRuleOnEvnt');
				LblDisplyRuleOnEvnt.style.display = 'none';
				var Trig_Cond_td9 = CreateTD(Add_Rule_tr2,'ItemLabelView');
				var Trig_Cond_span1 = CreateSPAN(Trig_Cond_td9,'','','Triggering Condition');
				var Trig_Cond_span2 = CreateSPAN(Trig_Cond_td9);
				Trig_Cond_span2.style.color = 'blue';	
				Trig_Cond_span2.style.fontSize = '12px';
				Trig_Cond_span2.innerHTML = '&nbsp;*';
				var Trig_Cond_td10 = CreateTD(Add_Rule_tr2,'','Rul_Trig_Cond_td');
				/*Trig_Cond_td10.innerHTML += "<textarea id='txtarea_Trig_Cond' rows='2' style='width:385px;' onfocus='focus_change_color(this.id)' onblur='blur_change_color(this.id)'></textarea><label id='Lbl_Disp_Trig_Cond' style='display:none'></label>";*/
				Trig_Cond_td10.innerHTML += "<div>Click <a style='vertical-align:top;' class='ahover' onclick='openTriggerDialog()'> here </a> to Add the Triggering Condition.</div>";
				Trig_Cond_td10.innerHTML += "<label id='Lbl_Disp_Trig_Cond' style='display:none'></label>";

			//TR3...
				var Add_Rule_tr4 = CreateTR(Add_Rule_table); 
				var R_Desc_td5 = CreateTD(Add_Rule_tr4,'ItemLabelView','','','','Description');
				// R_Desc_td5.style.height = '54px';
				var R_Desc_td6 = CreateTD(Add_Rule_tr4,'','Rul_Desc_td6');
				R_Desc_td6.colSpan = '3';
				var R_Desc_txtarea1 = CreateTEXTAREA(R_Desc_td6,'','txtarea_Description');
				// R_Desc_txtarea1.style.width = '385px';
				R_Desc_txtarea1.rows = '1';
				R_Desc_txtarea1.setAttribute('onfocus','focus_change_color(this.id)');
				R_Desc_txtarea1.setAttribute('onblur','blur_change_color(this.id)');
				var R_Desc_disp_label5 = CreateLABEL(R_Desc_td6,'normal_font','label_Description');
				R_Desc_disp_label5.style.display = 'none';
			//Table for Display LBL and Save Button...
				AddRuleDiv1.innerHTML += "<table align='center' width='90%'><tr><td width='30%'></td><td width='40%' align='center'><div id='div_Err' style='visibility:hidden;background-color:#FFDC77;text-align:center'></div></td><td align='right' width='25%'><input type='button' id='Add_Rule_Sav' class='ui_widget' style='width:60px;background:#EEEEEE;' onclick='Sav_Rule(0)' value='Save'>&nbsp;&nbsp;&nbsp;&nbsp;</td></tr></table>";
				var hide_field=CreateHIDDEN(AddRuleDiv1,'', 'work_flow_id');
				if(Param_passed_Id != "false"){
					hide_field.value = Param_passed_Id;
					list_display(Param_passed_Id);
				}
				checked();
				Action_part();
			//Creation of Display rule...
				if(Param_passed_Id){
					var rule_disp_span = document.getElementById('label_disp_span');
					var rule_disp_label = CreateLABEL(rule_disp_span,'RuleActionLblClass','rule_disp_label','');
					rule_disp_label.align = 'center';
					sav2edit(Param_passed_Id,0);
				}
	}
			
	//Function for opening the Dialog Box for Triggering Condition...
	function openTriggerDialog(){
		$('#TriggerDialog').dialog({
			autoOpen:true,
			modal: true,			
			height:'400',
			width:'75%',
			closeOnEscape:true,
			title: 'Trigger Condition',
		});
		$('#TriggerDialog').dialog('option','position',[150,100]);
	}

	//Function Related to Action Part...
	function Action_part(){	
		var Action_part_Div = document.getElementById('action_div');
		Action_part_Div.style.display = 'none';
		var Action_part_div1 = CreateDIV(Action_part_Div,'','Main_Div','','90%');
		Action_part_div1.style.border = '1px solid #DDD';
		var div_empty = CreateDIV(Action_part_div1);
		// div_empty.style.height = '40px';
		Action_part_div1.innerHTML += "<div id='list_div' style='overflow:auto;width:90%'></div>";
	}
	
	//Function to Display the Title for the Action Dialogue box...
	function title_function(value){
		switch (value){
			case '1': 
					title = 'Action - Round Robin';
					return title;
					break;
			case '2':
					title = 'Action - Create Task ';
					return title;
					break;
			case '3':
					title = 'Action - Send Email ';
					return title;
					break;
			case '4':
					title = 'Action - Send SMS ';
					return title;
					break;
			case '5':
					title = 'Action - Update';
					return title;
					break;
			default: exit(0);
		}
	}

	//Function to display the List of Actions in a Dialogue Box...
	function dialog_model1(){
		$('#commonPopupDiv').dialog({
			autoOpen:true,
			modal: true,			
			height:'auto',
			width:'80%',
			title:'Create New Action',
			closeOnEscape:true,
			resizable: false,
		});
		var dialog_div = document.getElementById('commonPopupDiv');
		dialog_div.innerHTML= '';
		var ActionUl = CreateUL(dialog_div,'lnkLstTabUL');

		//Assign Round Robin Button...
			var RRActionLi = CreateLI(ActionUl,'lnkLstTab','RRActionLi');
			RRActionLi.setAttribute('onclick','round_robin_div()');
			var RRActionLiTbl = CreateTable(RRActionLi,'lnkLstTbl');
			var RRActionTr = CreateTR(RRActionLiTbl);
			var RRActionTd1 = CreateTD(RRActionTr);
			RRActionTd1.style.width = '20%';
			var RRIMG = CreateIMG(RRActionTd1,'td_div_Style');
			var RRActionTd2 = CreateTD(RRActionTr);
			RRActionTd2.style.verticalAlign = 'middle';
			var RRDivHeader = CreateDIV(RRActionTd2,'lnkLstHeading','','Assign Round Robin'); 
			var RRDivDesc = CreateDIV(RRActionTd2,'lnkLstDesc','','Assign Round Robin');

		//Create Task Button...
			var CTActionLi = CreateLI(ActionUl,'lnkLstTab','CTActionLi');
			CTActionLi.setAttribute('onclick','Create_task()');
			var CTActionLiTbl = CreateTable(CTActionLi,'lnkLstTbl');
			var CTActionTr = CreateTR(CTActionLiTbl);
			var CTActionTd1 = CreateTD(CTActionTr);
			CTActionTd1.style.width = '20%';
			var CTIMG = CreateIMG(CTActionTd1,'img_style','','/atCRM/images/C_task.png');
			var CTActionTd2 = CreateTD(CTActionTr);
			CTActionTd2.style.verticalAlign = 'middle';
			var CTDivHeader = CreateDIV(CTActionTd2,'lnkLstHeading','','Create Task'); 
			var CTDivDesc = CreateDIV(CTActionTd2,'lnkLstDesc','','Helps to make an appointment, reminding the task where the customer needs to perform');
		
		//Send Email Button...
			var MailActionLi = CreateLI(ActionUl,'lnkLstTab','MailActionLi');
			MailActionLi.setAttribute('onclick','send_mail()');
			var MailActionLiTbl = CreateTable(MailActionLi,'lnkLstTbl');
			var MailActionTr = CreateTR(MailActionLiTbl);
			var MailActionTd1 = CreateTD(MailActionTr);
			MailActionTd1.style.width = '20%';
			var MailIMG = CreateIMG(MailActionTd1,'td_mail_style','','/atCRM/images/mail3.png');
			var MailActionTd2 = CreateTD(MailActionTr); 
			MailActionTd2.style.verticalAlign = 'middle';
			var MailDivHeader = CreateDIV(MailActionTd2,'lnkLstHeading','','Send Email'); 
			var MailDivDesc = CreateDIV(MailActionTd2,'lnkLstDesc','','Helps to send an E-mail to the particulars');
		
		//Send SMS Button...
			var smsActionLi = CreateLI(ActionUl,'lnkLstTab','smsActionLi');
			smsActionLi.setAttribute('onclick','send_sms()');
			var smsActionLiTbl = CreateTable(smsActionLi,'lnkLstTbl');
			var smsActionTr = CreateTR(smsActionLiTbl);
			var smsActionTd1 = CreateTD(smsActionTr);
			smsActionTd1.style.width = '20%';
			var smsIMG = CreateIMG(smsActionTd1,'td_sms_Style');
			var smsActionTd2 = CreateTD(smsActionTr);
			smsActionTd2.style.verticalAlign = 'middle';
			var smsDivHeader = CreateDIV(smsActionTd2,'lnkLstHeading','','Send SMS'); 
			var smsDivDesc = CreateDIV(smsActionTd2,'lnkLstDesc','','Helps to send a SMS to the particulars');

		//Update Action Button...
			var UpdtActionLi = CreateLI(ActionUl,'lnkLstTab','UpdtActionLi');
			UpdtActionLi.setAttribute('onclick','update()');
			var UpdtActionLiTbl = CreateTable(UpdtActionLi,'lnkLstTbl');
			var UpdtActionTr = CreateTR(UpdtActionLiTbl);
			var UpdtActionTd1 = CreateTD(UpdtActionTr);
			UpdtActionTd1.style.width = '20%';
			var UpdtIMG = CreateIMG(UpdtActionTd1,'td_update_style','','/atCRM/images/U_date.png');
			var UpdtActionTd2 = CreateTD(UpdtActionTr);
			UpdtActionTd2.style.verticalAlign = 'middle';
			var UpdtDivHeader = CreateDIV(UpdtActionTd2,'lnkLstHeading','','Update'); 
			var UpdtDivDesc = CreateDIV(UpdtActionTd2,'lnkLstDesc','','Updates the Customs fiels, Contacts etc.,');
	}
			
	//Function to Add Dialogue..
	function add_dialogue(value){
	    $('#commonPopupDiv').dialog({
			autoOpen:true,
			modal: true,			
			position: 'center',
			closeOnEscape:true,
			title: title_function(value),
		});
		Edt_Load = 0;
	}
	
	//Function to Close Dialogue.. 
	function Close_Action_dialog(){
		$('#commonPopupDiv').dialog('close');
		Edt_Load = 0;
	}

	//function to create the Round-Robin Div...
	function round_robin_div(IsEditUpdtFlg){	
		var RRDivContent = "<table width='90%' align='center' nowrap>";
		RRDivContent += "<tr><td class='td_class1'>Assignment in Column</td><td class='td_class2'><select id='select_Assign_Colmn' onfocus='focus_change_color(this.id)' onblur='blur_change_color(this.id)'></select><label id='Lbl_select_Assign_Colmn' style='display:none;'></label></td><td class='td_class1'>Last assigned at</td><td><span id='span_Last_assign_at'></span></td></tr>";
		RRDivContent += "<tr><td class='td_class1'>Last assigned to</td><td><span id='Last_assign2_span2'></span></td><td>History CSV</td><td><textarea id='txtArea_RR_Hist_CSV' onfocus='focus_change_color(this.id)' onblur='blur_change_color(this.id)'></textarea><label style='display:none' id='Lbl_Histry_CSV_txtArea'></label></td></tr>";
		RRDivContent += "<tr><td>Candidate SQL</td><td><textarea id='txtArea_RR_SQL' onfocus='focus_change_color(this.id)' onblur='blur_change_color(this.id)'></textarea><label id='Lbl_RR_SQL_textArea' style='display:none'></label></td>";
		RRDivContent += "<td class='td_class1'>Last assigned rec</td><td class='td_class2'><textarea onfocus='focus_change_color(this.id)' onblur='blur_change_color(this.id)' id='RR_L_assign_rec_txtBox'></textarea><label id='Lbl_RR_L_assign_rec_txtBox' style='display:none'></label></td></tr>";
		RRDivContent += "</table>";
		RRDivContent += "<table width='100%'>";
		RRDivContent += "<tr><td class='td_class1'><input type='hidden' id='RR_Action_id' /></td><td align='right'><input type='button' style='width:60px;' onclick='rr_sav_Action()' class='ui-widget' id='robin_save' value='Save'/>&nbsp;&nbsp;<input type='button' style='margin-right:25px;width:60px;' class='ui-widget' onclick='Close_Action_dialog()' value='Close'/></td><tr>";
		RRDivContent += "</table>";
		RRDivContent += "<div id='RR_Div_disp_Lbl' align='center' style='display:none'><label class='DisplayLabelClass' style='width:45%;background-color:#FFDC77' id='RR_Action_Disp_Lbl'>Round Robin Action Saved Successfully.</label></div>";
		
		document.getElementById('commonPopupDiv').innerHTML = RRDivContent;

		if(IsEditUpdtFlg == 0){
			document.getElementById('select_Assign_Colmn').style.display = 'none';
			var LblSlctAssignColmn = document.getElementById('Lbl_select_Assign_Colmn');
			LblSlctAssignColmn.style.display = 'inline';
			LblSlctAssignColmn.innerHTML = rr_entt_column;

			var SpanLstAssignAt = document.getElementById('span_Last_assign_at');
			SpanLstAssignAt.style.display = 'bold';
			SpanLstAssignAt.innerHTML = rr_last_assigned_at;

			var SpnLstassign2 = document.getElementById('Last_assign2_span2');
			SpnLstassign2.style.display = 'bold';
			SpnLstassign2.innerHTML = rr_last_assigned_to;

			document.getElementById('txtArea_RR_Hist_CSV').style.display = 'none';
			var LblHstryCSVTxtArea = document.getElementById('Lbl_Histry_CSV_txtArea');
			LblHstryCSVTxtArea.style.display = 'inline';
			LblHstryCSVTxtArea.innerHTML = rr_history_csv;

			document.getElementById('txtArea_RR_SQL').style.display = 'none';
			var LblRRSqlTextArea = document.getElementById('Lbl_RR_SQL_textArea');
			LblRRSqlTextArea.style.display = 'inline';
			LblRRSqlTextArea.innerHTML = rr_candidate_sql;

			document.getElementById('RR_L_assign_rec_txtBox').style.display = 'none';
			var LblRRAssignRecTxtBox = document.getElementById('Lbl_RR_L_assign_rec_txtBox');
			//LblRRAssignRecTxtBox.className = 'SavedPhaseClass';
			LblRRAssignRecTxtBox.style.display = 'inline';
			LblRRAssignRecTxtBox.innerHTML = rr_last_assigned_rec_id;

			document.getElementById('robin_save').value = 'Edit';
			document.getElementById('robin_save').setAttribute("onclick","round_robin_div(1);");
		}

		else if(IsEditUpdtFlg == 1){
			document.getElementById('txtArea_RR_Hist_CSV').value = rr_history_csv;
			document.getElementById('txtArea_RR_SQL').value = rr_candidate_sql;
			document.getElementById('RR_L_assign_rec_txtBox').value = rr_last_assigned_rec_id;

			document.getElementById('robin_save').value = 'Update';
			document.getElementById('robin_save').setAttribute("onclick","rr_sav_Action();");
		}

		$('#commonPopupDiv').dialog({
		autoOpen:true,
		modal: true,
		title:'Action - Round Robin',
		position:'center',
		resizable:false
		});
	}
		
	function Checking_Cond(){
		if(document.getElementById('select_C_T_assign_type').value == 'Selected user')
		document.getElementById('CT_Smrt_Suggest').style.visibility = 'visible';
		else
		document.getElementById('CT_Smrt_Suggest').style.visibility = 'hidden';
	}

	//Function to Create the Create Task Action...
	function Create_task(IsEdtUpdtFlg){	
		document.getElementById('commonPopupDiv').innerHTML = '';
	    $('#commonPopupDiv').dialog({
			autoOpen:true,
			modal: true,			
			height:'auto',
			position:'center',
			closeOnEscape:true,
			title:'Action - Create Task'
		});
		var Div_block=document.getElementById("commonPopupDiv");
		var Ctask_table = CreateTable(Div_block);
		Ctask_table.align = 'center';
		Ctask_table.style.borderCollapse = 'collapse';
		Ctask_table.cellPadding = '10';
		Ctask_table.cellSpacing = '3';
		Ctask_table.style.width = "90%";
		//TR_1...
		var Ctask_tr1 = CreateTR(Ctask_table);
			var Ctask_Assing_typ_td1 = CreateTD(Ctask_tr1,'normal_font','','','left','Subject');
			Ctask_Assing_typ_td1.style.width = '20%';
			var Ctask_Assing_typ_td2 = CreateTD(Ctask_tr1,'normal_font');
			Ctask_Assing_typ_td2.colSpan = '3';
			var txtBox_subject = CreateTEXTBOX(Ctask_Assing_typ_td2,'txtBox_class normal_font ','Ctask_Subject_txt');
			txtBox_subject.setAttribute('onfocus','focus_change_color(this.id)');
			txtBox_subject.setAttribute('onblur','blur_change_color(this.id)');
			txtBox_subject.style.width = '90%';
			var Lbl_txtBox_subject = CreateLABEL(Ctask_Assing_typ_td2,'','Lbl_C_T_txtBox_subject');
			Lbl_txtBox_subject.style.display = 'none';
		//TR_2...
		var Ctask_tr2 = CreateTR(Ctask_table);
			var Ctask_subject_td3 = CreateTD(Ctask_tr2,'normal_font','','','left','Assign to');
			var Ctask_subject_td4 = CreateTD(Ctask_tr2,'normal_font');
			Ctask_subject_td4.colSpan = '3';
			var CT_Span1 = CreateSPAN(Ctask_subject_td4);
			var select_Assing_typ = CreateSelectBox(CT_Span1,' normal_font ','select_C_T_assign_type');
			select_Assing_typ.style.width = '165px';
			select_Assing_typ.setAttribute('onfocus','focus_change_color(this.id)');
			select_Assing_typ.setAttribute('onblur','blur_change_color(this.id)');
			var sel_opt1_CU = CreateOptionBox(select_Assing_typ,'','Assing_typ_opt1','Current user','Current User');
			var sel_opt2_CUM = CreateOptionBox(select_Assing_typ,'','Assing_typ_opt2',"Current user's manager","Current User's manager");
			var sel_opt3_TO = CreateOptionBox(select_Assing_typ,'','Assing_typ_opt3','Terr owner','Terr owner');
			var sel_opt4_RCB = CreateOptionBox(select_Assing_typ,'','Assing_typ_opt4','Rec crtd by','Rec crtd by');
			var sel_opt5_RLMB = CreateOptionBox(select_Assing_typ,'','Assing_typ_opt5','Rec last mod by','Rec last mod by');
			var sel_opt6_SU = CreateOptionBox(select_Assing_typ,'','Assing_typ_opt6','Selected user','Selected user');
			document.getElementById('select_C_T_assign_type').setAttribute('onchange','Checking_Cond()');
			var Lbl_select_Assing_typ = CreateLABEL(CT_Span1,'','Lbl_C_T_select_Assing_typ');
			Lbl_select_Assing_typ.style.display = 'none';
			var CT_Span2 = CreateSPAN(Ctask_subject_td4,'','CT_Smrt_Suggest');
			CT_Span2.style.visibility = 'hidden';
			CT_Span2.innerHTML += "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type='hidden' name='Smrt_Suggst_Hidden' id='Smrt_Suggst_Hidden' value=''><input type='text' name='Smrt_Suggst_Txt' id='Smrt_Suggst_Txt'  value='2 chars or **' onkeyup=\"parent.callAjaxAfterDelay('multiSelectSugg',this,event,'/atCRM/custom/JSON/smartSuggest/genericPicklist.xml?pckListName=SBEUser',this.value);\" onfocus='parent.changeSmartSuggestTxt(this);' onblur='parent.changeSmartSuggestTxt(this);' style=\"width:28%;border:1px solid #CCCCCC;opacity:0.7\">";
			CT_Span2.innerHTML += "<a onclick=\"parent.populatePicklist('SBEUser','SBEUser','commonPickListDiv');\" id='Smrt_Suggst_Pck'><img style=\"cursor:pointer;margin-left:2px;\" src='/atCRM/images/JSON/picklist.png'></a>";
		//TR_3...
		var Ctask_tr3 = CreateTR(Ctask_table);
			 var Ctask_Note_td5 = CreateTD(Ctask_tr3,'normal_font','','','left','Notes');
			 var Ctask_Note_td6 = CreateTD(Ctask_tr3,'normal_font');
			 Ctask_Note_td6.style.width ='410px';
			 Ctask_Note_td6.style.height = '50px';
			 Ctask_Note_td6.colSpan = '3';
			 var textArea_CTask_Note = CreateTEXTAREA(Ctask_Note_td6,'','txtArea_Ctask_Not');
			 textArea_CTask_Note.cols = '60';
			 textArea_CTask_Note.setAttribute('onfocus','focus_change_color(this.id)');
			 textArea_CTask_Note.setAttribute('onblur','blur_change_color(this.id)');
			 var Lbl_textArea_CTask_Note = CreateLABEL(Ctask_Note_td6,'','Lbl_C_T_textArea_CTask_Note');
			 Lbl_textArea_CTask_Note.style.display = 'none';
		//TR_4...
		var Ctask_tr4 = CreateTR(Ctask_table);
			var Ctask_offset_td7 = CreateTD(Ctask_tr4,'normal_font','','','left','Task Starts');
			var Ctask_offset_td8 = CreateTD(Ctask_tr4,'normal_font');
			Ctask_offset_td8.colSpan = '3';
			var select_ofset_hrs = CreateSelectBox(Ctask_offset_td8,'','select_C_T_offset_hrs');
			select_ofset_hrs.style.width = '130px';
			select_ofset_hrs.setAttribute('onfocus','focus_change_color(this.id)');
			select_ofset_hrs.setAttribute('onblur','blur_change_color(this.id)');
			var offset_hrs_opt1 = CreateOptionBox(select_ofset_hrs,'','ofset_hrs_opt1','15 min','15.00 min');
			var offset_hrs_opt2 = CreateOptionBox(select_ofset_hrs,'','ofset_hrs_opt2','30 min','30.00 min');
			var offset_hrs_opt3 = CreateOptionBox(select_ofset_hrs,'','ofset_hrs_opt3','45 min','45.00 min');
			var offset_hrs_opt4 = CreateOptionBox(select_ofset_hrs,'','ofset_hrs_opt4','1 hr','1 hr');
			var Lbl_select_ofset_hrs = CreateLABEL(Ctask_offset_td8,'','Lbl_C_T_select_ofset_hrs');
			Lbl_select_ofset_hrs.style.display = 'none';
			Ctask_offset_td8.innerHTML += '&nbsp;&nbsp;&nbsp;&nbsp;After';
			Ctask_offset_td8.innerHTML += "&nbsp;&nbsp;&nbsp;&nbsp;<select style='width:150px' class='' id='select_C_T_strt_offset' onfocus='focus_change_color(this.id)' onblur='blur_change_color(this.id)'><option>Rec crtd date</option><option>Rec last mod date</option><option>Current user crtd date</option><option>Current user last login</option><option>Rule Trigger date</option></select>";
			Ctask_offset_td8.innerHTML += "<label id='Lbl_C_T_select_task_offset' style='display:none'></label>";
		//TR_5...
		var Ctask_tr5 = CreateTR(Ctask_table);
			var Ctask_task_typ_td13 = CreateTD(Ctask_tr5,'normal_font','','','left','Type');
			var Ctask_task_typ_td14 = CreateTD(Ctask_tr5,'normal_font','','','left');
			var select_task_typ = CreateSelectBox(Ctask_task_typ_td14,' ','select_C_T_task_typ');
			select_task_typ.style.width = '130px';
			select_task_typ.setAttribute('onfocus','focus_change_color(this.id)');
			select_task_typ.setAttribute('onblur','blur_change_color(this.id)');
			get_objects('actvt_type','select_C_T_task_typ');
			var Lbl_select_task_typ = CreateLABEL(Ctask_task_typ_td14,'','Lbl_C_T_select_task_typ');
			Lbl_select_task_typ.style.display = 'none';
			var Ctask_task_status_td15 = CreateTD(Ctask_tr5,'normal_font','','','left','Status');
			var Ctask_task_status_td16 = CreateTD(Ctask_tr5,'','','','left');
			var select_task_status = CreateSelectBox(Ctask_task_status_td16,' ','select_C_T_task_status');
			select_task_status.style.width = '125px';
			select_task_status.setAttribute('onfocus','focus_change_color(this.id)');
			select_task_status.setAttribute('onblur','blur_change_color(this.id)');
			get_objects('actvt_status','select_C_T_task_status');
			var Lbl_select_task_status = CreateLABEL(Ctask_task_status_td16,'','Lbl_C_T_select_task_status');
			Lbl_select_task_status.style.display = 'none';
		//TR_5 Hidden_field...
		var Buttn_Tbl = CreateTable(Div_block);
		Buttn_Tbl.style.width ='100%';
		var Btn_tr1 = CreateTR(Buttn_Tbl);
			var CT_HiddenField_td1 = CreateTD(Btn_tr1,'');
			CT_HiddenField_td1.width = '50%';
			var CT_Act_hidden_field = CreateHIDDEN(CT_HiddenField_td1,'','C_Task_Action_id');
			Btn_tr1.innerHTML += "<td width='50%' align='right'><input type='button' style='width:60px;' id='task_save' class='ui-widget' value='Save' onclick='Ctask_Action_save()'/>&nbsp;&nbsp;<input type='button' id='task_close' style='margin-right:25px;width:60px;' value='Close' class='ui-widget' onclick='Close_Action_dialog()' /></td>";
		//Disp_Lbl
			var Disp_Lbl_Div = CreateDIV(Div_block,'','CT_Div_disp_Lbl');
			Disp_Lbl_Div.align = 'center';
			Disp_Lbl_Div.style.display = 'none';
			var CT_Disp_Lbl = CreateLABEL(Disp_Lbl_Div,'DisplayLabelClass','CT_Action_Disp_Lbl','Create Task Action Saved Successfully.');
			CT_Disp_Lbl.style.width = '45%';
			CT_Disp_Lbl.style.backgroundColor = '#FFDC77';

			if(IsEdtUpdtFlg == 0){
				document.getElementById('Ctask_Subject_txt').style.display = 'none';
				var LblCTTxtBoxSubj = document.getElementById('Lbl_C_T_txtBox_subject');
				LblCTTxtBoxSubj.style.display = 'inline';	
				LblCTTxtBoxSubj.innerHTML = CT_subject;
				
				document.getElementById('select_C_T_assign_type').style.display = 'none';
				var LblCTSelectAssingTyp= document.getElementById('Lbl_C_T_select_Assing_typ');
				LblCTSelectAssingTyp.style.display = 'inline';	
				LblCTSelectAssingTyp.innerHTML = CT_assign_type;

				document.getElementById('txtArea_Ctask_Not').style.display = 'none';
				var LblCTTextAreaNote = document.getElementById('Lbl_C_T_textArea_CTask_Note');
				LblCTTextAreaNote.style.display = 'inline';
				LblCTTextAreaNote.innerHTML = CT_notes;

				document.getElementById('select_C_T_offset_hrs').style.display = 'none';
				var LblCTSelectOffsetHrs = document.getElementById('Lbl_C_T_select_ofset_hrs');
				LblCTSelectOffsetHrs.style.display = 'inline';
				LblCTSelectOffsetHrs.innerHTML = CT_start_offset_hrs;
				
				document.getElementById('select_C_T_strt_offset').style.display = 'none';
				var LblCTSelectTskOffset = document.getElementById('Lbl_C_T_select_task_offset');
				LblCTSelectTskOffset.style.display = 'inline';
				LblCTSelectTskOffset.innerHTML = CT_start_offset_from;

				document.getElementById('select_C_T_task_typ').style.display = 'none';
				var LblCTSelectTskTyp = document.getElementById('Lbl_C_T_select_task_typ');
				LblCTSelectTskTyp.style.display = 'inline';
				LblCTSelectTskTyp.innerHTML = CT_actvt_type;
				
				document.getElementById('select_C_T_task_status').style.display = 'none';
				var LblCTSelectTskStatus = document.getElementById('Lbl_C_T_select_task_status');
				LblCTSelectTskStatus.style.display = 'inline';
				LblCTSelectTskStatus.innerHTML = CT_actvt_status;

				document.getElementById('task_save').value = 'Edit';
				document.getElementById('task_save').setAttribute("onclick","Create_task(1)");

				document.getElementById('CT_Div_disp_Lbl').style.display = 'inline';
				setTimeout("document.getElementById('CT_Div_disp_Lbl').style.display='none'",2000);
			}
			
			else if(IsEdtUpdtFlg == 1){
				document.getElementById('Ctask_Subject_txt').value = CT_subject;
				document.getElementById('select_C_T_assign_type').value = CT_assign_type;
				document.getElementById('txtArea_Ctask_Not').value = CT_notes;
				document.getElementById('select_C_T_offset_hrs').value = CT_start_offset_hrs;
				document.getElementById('select_C_T_strt_offset').value = CT_start_offset_from;
				document.getElementById('select_C_T_task_typ').value = CT_actvt_type;
				document.getElementById('select_C_T_task_status').value = CT_actvt_status;

				document.getElementById('task_save').value = 'Update';
				document.getElementById('task_save').setAttribute("onclick","Ctask_Action_save()");
				
				document.getElementById('CT_Action_Disp_Lbl').innerHTML = 'Create Task Action Updated Successfully.';
				document.getElementById('CT_Div_disp_Lbl').style.display = 'inline';
				setTimeout("document.getElementById('CT_Div_disp_Lbl').style.display='none'",2000);
			}

	}
		
	//Function to Create the Send Email Action...
	function send_mail(IsEdtUpdtFlg){
		 $('#commonPopupDiv').dialog({
			autoOpen:true,
			modal: true,
			position: 'center',
			closeOnEscape:true,
			title: 'Action - Send Email'
		});

		var Div_block=document.getElementById("commonPopupDiv");
		Div_block.innerHTML = '';
		var Email_table = CreateTable(Div_block);
		Email_table.align = 'center';
		Email_table.style.width = '90%';
		Email_table.cellPadding = '10';
		Email_table.cellSpacing = '3';
		Email_table.style.borderCollapse = 'collapse';
		//TR_1...
		var Email_tr1 = CreateTR(Email_table);
			var mail_tmplt_td1 = CreateTD(Email_tr1,'td_class1','','','left','Email Template');
			var mail_tmplt_td2 = CreateTD(Email_tr1,'td_class2','','','left');			
			var select_mail_tmplt = CreateSelectBox(mail_tmplt_td2,'','mailsel_tmplt');
			select_mail_tmplt.setAttribute('onfocus','focus_change_color(this.id)');
			select_mail_tmplt.setAttribute('onblur','blur_change_color(this.id)');
			get_objects('email_templt','mailsel_tmplt');
			var Lbl_select_mail_tmplt = CreateLABEL(mail_tmplt_td2,'','Lbl_select_mail_tmplt');
			Lbl_select_mail_tmplt.style.display = 'none';
			var Email_Subj_td3 = CreateTD(Email_tr1,'td_class1','','','left','Subject');
			var Email_Subj_td4 = CreateTD(Email_tr1,'td_class2','','','left');
			var txtBox_mail_subj = CreateTEXTBOX(Email_Subj_td4,'txtBox_class','txtBox_Email_Subj');
			txtBox_mail_subj.setAttribute('onfocus','focus_change_color(this.id)');
			txtBox_mail_subj.setAttribute('onblur','blur_change_color(this.id)');
			var txtBox_mail_subj = CreateLABEL(Email_Subj_td4,'','Lbl_txtBox_mail_subj');
			txtBox_mail_subj.style.display = 'none';
		//TR_2...
		var Email_tr2 = CreateTR(Email_table);
			var send_Email_td5 = CreateTD(Email_tr2,'td_class1','','','left','Send Email to');	
			var send_Email_td6 = CreateTD(Email_tr2,'td_class2','','','left');
			send_Email_td6.style.width = '225px';
			send_Email_td6.style.height = '89px';
			var select_send_mail_to = CreateSelectBox(send_Email_td6,'','select_send_mail_to','','2');
			select_send_mail_to.setAttribute('onfocus','focus_change_color(this.id)');
			select_send_mail_to.setAttribute('onblur','blur_change_color(this.id)');
			var send_mail_opt1 = CreateOptionBox(select_send_mail_to,'','','Current User','Current User');
			var send_mail_opt2 = CreateOptionBox(select_send_mail_to,'','',"Current User's Manager","Current User's Manager");
			var send_mail_opt3 = CreateOptionBox(select_send_mail_to,'','','Terr owner','Terr owner');
			var send_mail_opt4 = CreateOptionBox(select_send_mail_to,'','','Rec crtd by','Rec crtd by');
			var send_mail_opt5 = CreateOptionBox(select_send_mail_to,'','','Rec last mod by','Rec last mod by');
			var send_mail_opt6 = CreateOptionBox(select_send_mail_to,'','','Xn contact','Xn contact');
			var Lbl_select_send_mail_to = CreateLABEL(send_Email_td6,'','Lbl_select_send_mail_to');
			Lbl_select_send_mail_to.style.display = 'none';
			var snd_speci_ppl_td7 = CreateTD(Email_tr2,'td_class1','','','left','Also send to specific people');
			var snd_speci_ppl_td8 = CreateTD(Email_tr2,'td_class2','','','left');
			window["array_Mail_snd_ppl"] = new Array();
			snd_speci_ppl_td8.innerHTML += "<table><tr><td><input type='hidden' name='Mail_snd_ppl_hide1' id='Mail_snd_ppl_hide1'><input type='hidden'  id='Mail_snd_ppl' name='Mail_snd_ppl'><input type='hidden' id='Mail_snd_ppl-max' name='Mail_snd_ppl-max' value='10'><input type='hidden' id='Mail_snd_ppl-fun' name='Mail_snd_ppl-fun' value=''><input type='text' id='Mail_snd_ppltxt' name='Mail_snd_ppltxt' class='ui-corner-all multiSelectTxt' style=\"width:200px;\" onfocus='parent.changeMultiTxt(this);' onkeyup=\"parent.callAjaxAfterDelay('multiSelectSugg',this,event,'/atCRM/custom/JSON/smartSuggest/genericPicklist.xml?pckListName=Contact',this.value);\" onblur='parent.changeMultiTxt(this);' value='2 chars or **'></td></tr><tr><td><div class='multiSelectBox' name='Mail_snd_ppl-multiSelDiv' id='Mail_snd_ppl-multiSelDiv'></div></td></tr></table>";
		//TR_3...
		var Email_tr3 = CreateTR(Email_table);
			var cpy_mail_td9 = CreateTD(Email_tr3,'td_class1','','','left','Copy Email To');
			var cpy_mail_td10 = CreateTD(Email_tr3,'td_class2','','','left');
			cpy_mail_td10.style.width = '225px';
			cpy_mail_td10.style.height = '89px';
			var select_cpy_mail = CreateSelectBox(cpy_mail_td10,'','select_copy_mail','','2'); 
			select_cpy_mail.setAttribute('onfocus','focus_change_color(this.id)');
			select_cpy_mail.setAttribute('onblur','blur_change_color(this.id)');
			var cpy_mail_opt1 = CreateOptionBox(select_cpy_mail,'','','Current User','Current User');
			var cpy_mail_opt2 = CreateOptionBox(select_cpy_mail,'','',"Current User's Manager","Current User's Manager");
			var cpy_mail_opt3 = CreateOptionBox(select_cpy_mail,'','','Terr owner','Terr owner');
			var cpy_mail_opt4 = CreateOptionBox(select_cpy_mail,'','','Rec crtd by','Rec crtd by');
			var cpy_mail_opt5 = CreateOptionBox(select_cpy_mail,'','','Rec last mod by','Rec last mod by');
			var cpy_mail_opt6 = CreateOptionBox(select_cpy_mail,'','','Selected contact','Selected contact');
			var Lbl_select_cpy_mail = CreateLABEL(cpy_mail_td10,'','Lbl_select_cpy_mail');
			Lbl_select_cpy_mail.style.display = 'none';
			var cpy_mail_ppl_td11 = CreateTD(Email_tr3,'td_class1','mail_td11','','left','Also copy to specific people');
			var cpy_mail_ppl_td12 = CreateTD(Email_tr3,'td_class2','mail_td12','','left');
			window["array_Mail_cpy_ppl"] = new Array();
			cpy_mail_ppl_td12.innerHTML += "<table><tr><td><input type='hidden' name='Mail_cpy_ppl_hide1' id='Mail_cpy_ppl_hide1'><input type='hidden'  id='Mail_cpy_ppl' name='Mail_cpy_ppl'><input type='hidden' id='Mail_cpy_ppl-max' name='Mail_cpy_ppl-max' value='10'><input type='hidden' id='Mail_cpy_ppl-fun' name='Mail_cpy_ppl-fun' value=''><input type='text' id='Mail_cpy_ppltxt' name='Mail_cpy_ppltxt' class='ui-corner-all multiSelectTxt' style=\"width:200px;\" onkeyup=\"parent.callAjaxAfterDelay('multiSelectSugg',this,event,'/atCRM/custom/JSON/smartSuggest/genericPicklist.xml?pckListName=Contact',this.value);\" onfocus='parent.changeMultiTxt(this);' onblur='parent.changeMultiTxt(this);' value='2 chars or **'></td></tr><tr><td><div class='multiSelectBox' id='Mail_cpy_ppl-multiSelDiv'></div></td></tr></table>";
		//Hidden_field, Sav_button...
		var Buttn_Tbl = CreateTable(Div_block);
		Buttn_Tbl.style.width ='100%';
		var Btn_tr1 = CreateTR(Buttn_Tbl);
			var mail_HiddenField_td1 = CreateTD(Btn_tr1);
			mail_HiddenField_td1.width = '50%';
			var CT_Act_hidden_field = CreateHIDDEN(mail_HiddenField_td1,'','Mail_Task_Action_id');
			Btn_tr1.innerHTML += "<td width='50%' align='right'><input type='button' style='width:60px;' id='mail_save' class='ui-widget' value='Save' onclick='mail_Action_save()'/>&nbsp;&nbsp;<input type='button' style='margin-right:25px;width:60px;' id='mail_close' value='Close' class='ui-widget' onclick='Close_Action_dialog()' /></td>";
		//Disp_Lbl
			var Disp_Lbl_Div = CreateDIV(Div_block,'','mail_Div_disp_Lbl');
			Disp_Lbl_Div.align = 'center';
			Disp_Lbl_Div.style.display = 'none';
			var mail_Disp_Lbl = CreateLABEL(Disp_Lbl_Div,'DisplayLabelClass','mail_Action_Disp_Lbl','Send Mail Action Saved Successfully.');
			mail_Disp_Lbl.style.width = '45%';
			mail_Disp_Lbl.style.backgroundColor = '#FFDC77';

//var e_send_to_conts_csv;
//var e_cc_to_conts_csv;
			if(IsEdtUpdtFlg == 0){
				document.getElementById('mailsel_tmplt').style.display = 'none';
				var LblSelectMailTmplt = document.getElementById('Lbl_select_mail_tmplt');
				LblSelectMailTmplt.style.display = 'inline';
				LblSelectMailTmplt.innerHTML = e_templt;

				document.getElementById('txtBox_Email_Subj').style.display = 'none';
				var LblTxtBoxMailSubj = document.getElementById('Lbl_txtBox_mail_subj');
				LblTxtBoxMailSubj.style.display = 'inline';
				LblTxtBoxMailSubj.innerHTML = e_subject;
				
				document.getElementById('select_send_mail_to').style.display = 'none';
				var LblSelectSndMail2 = document.getElementById('Lbl_select_send_mail_to');
				LblSelectSndMail2.style.display = 'inline';
				LblSelectSndMail2.innerHTML = e_send_to_types;
		
				document.getElementById('select_copy_mail').style.display = 'none';
				var	LblSelectCpyMail = document.getElementById('Lbl_select_cpy_mail');
				LblSelectCpyMail.style.display = 'inline';
				LblSelectCpyMail.innerHTML = e_cc_to_types;

				document.getElementById('mail_save').value = 'Edit';
				document.getElementById('mail_save').setAttribute("onclick","send_mail(1)");
				
				document.getElementById('mail_Div_disp_Lbl').style.display = 'inline';
				setTimeout("document.getElementById('mail_Div_disp_Lbl').style.display='none'",2000);
			}

			else if(IsEdtUpdtFlg == 1){
				document.getElementById('mailsel_tmplt').value = e_templt;
				document.getElementById('txtBox_Email_Subj').value = e_subject;
				document.getElementById('select_send_mail_to').value = e_send_to_types;
				document.getElementById('select_copy_mail').value = e_cc_to_types;
				
				document.getElementById('mail_save').value = 'Update';
				document.getElementById('mail_save').setAttribute("onclick","mail_Action_save()");

				document.getElementById('mail_Action_Disp_Lbl').innerHTML = 'Send Mail Action Updated Successfully.';
				document.getElementById('mail_Div_disp_Lbl').style.display = 'inline';
				setTimeout("document.getElementById('mail_Div_disp_Lbl').style.display='none'",2000);
			}
	}
		
//Function to Create the Send SMS Action...
	function send_sms(IsEdtUpdtFlg){	

	   $('#commonPopupDiv').dialog({
			autoOpen:true,
			modal: true,			
			height:'auto',
			width:'40%',
			position: 'center',
			closeOnEscape:true,
			title:'Action - Send SMS'
			});

		var Div_block=document.getElementById("commonPopupDiv");
		Div_block.innerHTML = '';
		var SMS_table = CreateTable(Div_block,'','sms_table');
		SMS_table.align = 'center';
		SMS_table.style.width = '90%';
		SMS_table.cellPadding = '10';
		SMS_table.cellSpacing = '3';
		SMS_table.style.borderCollapse = 'collapse';
		//TR_1...
		var Ssms_tr1 = CreateTR(SMS_table);
			var Ssms_td1 = CreateTD(Ssms_tr1,'td_class1','sms_td1','','left','SMS to be sent');
			Ssms_td1.style.width = '30%';
			var Ssms_td2 = CreateTD(Ssms_tr1,'td_class2','sms_td2','','left');
			Ssms_td2.style.width = '225px';
			Ssms_td2.style.height = '76px';
			var textArea_sms2sent = CreateTEXTAREA(Ssms_td2,' ','txtArea_sms2sent');
			textArea_sms2sent.setAttribute('onfocus','focus_change_color(this.id)');
			textArea_sms2sent.setAttribute('onblur','blur_change_color(this.id)');
			var Lbl_textArea_sms2sent = CreateLABEL(Ssms_td2,'','Lbl_textArea_sms2sent');
			Lbl_textArea_sms2sent.style.display = 'none';
		//TR_2...
		var Ssms_tr2 = CreateTR(SMS_table);
			var Send_sms_td3 = CreateTD(Ssms_tr2,'td_class1','sms_td3','','left','Send SMS to');
			var Send_sms_td4 = CreateTD(Ssms_tr2,'td_class2','sms_td4','','left');
			var select_send_sms = CreateSelectBox(Send_sms_td4,'','select_send_sms');
			select_send_sms.style.width = '220px';
			select_send_sms.setAttribute('onfocus','focus_change_color(this.id)');
			select_send_sms.setAttribute('onblur','blur_change_color(this.id)');
			var send_sms_opt1 = CreateOptionBox(select_send_sms,'','','Current User','Current User');
			var send_sms_opt2 = CreateOptionBox(select_send_sms,'','',"Current User's Manager","Current User's Manager");
			var send_sms_opt3 = CreateOptionBox(select_send_sms,'','','Terr owner','Terr owner');
			var send_sms_opt4 = CreateOptionBox(select_send_sms,'','','Rec crtd by','Rec crtd by');
			var send_sms_opt5 = CreateOptionBox(select_send_sms,'','','Rec last mod by','Rec last mod by');
			var send_sms_opt6 = CreateOptionBox(select_send_sms,'','','Xn contact','Xn contact');
			var send_sms_opt7 = CreateOptionBox(select_send_sms,'','','Selected contact','Selected contact');
			var Lbl_select_send_sms = CreateLABEL(Send_sms_td4,'','Lbl_select_send_sms');
			Lbl_select_send_sms.style.display = 'none';
		//TR_3...
			var Ssms_tr3 = CreateTR(SMS_table);
			var send_sms_ppl_td5 = CreateTD(Ssms_tr3,'td_class1','sms_td5','','left','Also send to specific people');
			var send_sms_ppl_td6 = CreateTD(Ssms_tr3,'td_class2','sms_td6','','left');
			send_sms_ppl_td6.colSpan = '3';
			window["array_Sms_snd_ppl"] = new Array();
			send_sms_ppl_td6.innerHTML += "<table><tr><td><input type='hidden' name='Sms_snd_ppl_hide' id='Sms_snd_ppl_hide'><input type='hidden' name='Sms_snd_ppl' id='Sms_snd_ppl'><input type='hidden' name='Sms_snd_ppl-max' id='Sms_snd_ppl-max' value='10'><input type='hidden' name='Sms_snd_ppl-fun' id='Sms_snd_ppl-fun' value=''><input style='width:200px' type='text' name='Sms_snd_ppltxt' id='Sms_snd_ppltxt' class='ui-corner-all multiSelectTxt' onkeyup=\"parent.callAjaxAfterDelay('multiSelectSugg',this,event,'/atCRM/custom/JSON/smartSuggest/genericPicklist.xml?pckListName=Contact',this.value);\" onfocus='parent.changeMultiTxt(this);' onblur='parent.changeMultiTxt(this);' value='2 chars or **'></td></tr><tr><td><div class='multiSelectBox' name='Sms_snd_ppl-multiSelDiv' id='Sms_snd_ppl-multiSelDiv'></div></td></tr></table>";
		//Hidden_field,Sav_button...
		var Buttn_Tbl = CreateTable(Div_block);
		Buttn_Tbl.style.width ='100%';
		var Btn_tr1 = CreateTR(Buttn_Tbl);
			var Sms_HiddenField_td1 = CreateTD(Btn_tr1);
			Sms_HiddenField_td1.width = '50%';
			var CT_Act_hidden_field = CreateHIDDEN(Sms_HiddenField_td1,'','sms_Action_id');
			Btn_tr1.innerHTML += "<td width='50%' align='right'><input type='button' style='width:60px;' id='sms_save' class='ui-widget' value='Save'  onclick='Sms_Action_save()'/>&nbsp;&nbsp;<input type='button' style='margin-right:25px;width:60px;' id='sms_close' value='Close' class='ui-widget' onclick='Close_Action_dialog()' /></td>";
		//Disp_Lbl
			var Disp_Lbl_Div = CreateDIV(Div_block,'','Sms_Div_disp_Lbl');
			Disp_Lbl_Div.align = 'center';
			Disp_Lbl_Div.style.display = 'none';
			var Sms_Disp_Lbl = CreateLABEL(Disp_Lbl_Div,'DisplayLabelClass','Sms_Action_Disp_Lbl','Send SMS Action Saved Successfully.');
			Sms_Disp_Lbl.style.width = '45%';
			Sms_Disp_Lbl.style.backgroundColor = '#FFDC77';
	
		//var s_send_to_conts_csv;
			if(IsEdtUpdtFlg == 0){
				document.getElementById('txtArea_sms2sent').style.display = 'none';
				var LblTxtAreaSms2sent = document.getElementById('Lbl_textArea_sms2sent');
				LblTxtAreaSms2sent.style.display = 'inline';
				LblTxtAreaSms2sent.innerHTML = s_mesg;

				document.getElementById('select_send_sms').style.display = 'none';
				var LblSelectSndSms = document.getElementById('Lbl_select_send_sms');
				LblSelectSndSms.style.display = 'inline';
				LblSelectSndSms.innerHTML = s_send_to_types;
				
				document.getElementById('sms_save').value = 'Edit';
				document.getElementById('sms_save').setAttribute("onclick","send_sms(1)");

				document.getElementById('Sms_Div_disp_Lbl').style.display = 'inline';
				setTimeout("document.getElementById('Sms_Div_disp_Lbl').style.display='none'",2000);
			}
			else if(IsEdtUpdtFlg == 1){
				document.getElementById('txtArea_sms2sent').value = s_mesg;
				document.getElementById('select_send_sms').value = s_send_to_types;

				document.getElementById('Sms_Action_Disp_Lbl').innerHTML = 'Send SMS Action Updated Successfully.';
				document.getElementById('Sms_Div_disp_Lbl').style.display = 'inline';
				setTimeout("document.getElementById('Sms_Div_disp_Lbl').style.display='none'",2000)
			}
	}
		
	//Function to Create the Update Action...
	function update(IsEdtUpdtFlg){	
		 $('#commonPopupDiv').dialog({
			autoOpen:true,
			modal: true,			
			height:'auto',
			width:'75%',
			closeOnEscape:true,
			title: 'Action - Update'
		});
		var Div_block=document.getElementById("commonPopupDiv");
		Div_block.innerHTML = '';
		var Update_table = CreateTable(Div_block,'','update_table');
		Update_table.align = 'center';
		Update_table.style.borderCollapse = 'collapse';
		Update_table.style.width = '90%';
		Update_table.cellPadding = '10';
		Update_table.cellSpacing = '3';
		//TR1...
		var update_tr1 = CreateTR(Update_table);
			var Field2update_td1 = CreateTD(update_tr1,'td_class1','ud_td1','','left','Field to Update');
			var Field2update_td2 = CreateTD(update_tr1,'td_class2','ud_td2','','left');
			var select_Field2update = CreateSelectBox(Field2update_td2,' ','select_fld2Updt');
			select_Field2update.setAttribute('onfocus','focus_change_color(this.id)');
			select_Field2update.setAttribute('onblur','blur_change_color(this.id)');
			var Lbl_select_Field2update = CreateLABEL(Field2update_td2,'','Lbl_select_Field2update');
			Lbl_select_Field2update.style.display = 'none';
			var Col2update_td3 = CreateTD(update_tr1,'td_class1','ud_td3','','left','Column to Update Name');
			var Col2update_td4 = CreateTD(update_tr1,'td_class2','ud_td4','','left');
			var txt_col2updt = CreateTEXTBOX(Col2update_td4,'txtBox_class ','txt_col2updt');
			txt_col2updt.setAttribute('onfocus','focus_change_color(this.id)');
			txt_col2updt.setAttribute('onblur','blur_change_color(this.id)');
			var Lbl_txt_col2updt = CreateLABEL(Col2update_td4,'','Lbl_txt_col2updt');
			Lbl_txt_col2updt.style.display = 'none';
		//TR_2...
		var update_tr2 = CreateTR(Update_table);
			var tbl2update_td5 = CreateTD(update_tr2,'td_class1','ud_td5','','left','Object to Update');
			var tbl2update_td6 = CreateTD(update_tr2,'td_class2','ud_td6','','left');
			var sel_Obj2updt = CreateSelectBox(tbl2update_td6,' ','select_Obj2updt');
			sel_Obj2updt.setAttribute('onfocus','focus_change_color(this.id)');
			sel_Obj2updt.setAttribute('onblur','blur_change_color(this.id)');
			var Lbl_sel_Obj2updt = CreateLABEL(tbl2update_td6,'','Lbl_sel_Obj2updt');
			Lbl_sel_Obj2updt.style.display = 'none';
			var tbl2update_td7 = CreateTD(update_tr2,'td_class1','ud_td7','','left','Table to Update Name');
			var tbl2update_td8 = CreateTD(update_tr2,'td_class2','ud_td8','','left');
			var txt_tbl2Updt = CreateTEXTBOX(tbl2update_td8,'txtBox_class ','txt_tbl2updt');
			txt_tbl2Updt.setAttribute('onfocus','focus_change_color(this.id)');
			txt_tbl2Updt.setAttribute('onblur','blur_change_color(this.id)');
			var Lbl_txt_tbl2Updt = CreateLABEL(tbl2update_td8,'','Lbl_txt_tbl2Updt');
			Lbl_txt_tbl2Updt.style.display = 'none';
		//Tr_3...
		var update_tr3 = CreateTR(Update_table);
			var update_formula_td9 = CreateTD(update_tr3,'td_class1','ud_td9','','left','Formula');
			var update_formula_td10 = CreateTD(update_tr3,'td_class2','ud_td10','','left');
			update_formula_td10.style.width = '210px';
			update_formula_td10.style.height = '56px';
			var textArea_formula_updt = CreateTEXTAREA(update_formula_td10,' ','txtArea_formula2updt');
			textArea_formula_updt.setAttribute('onfocus','focus_change_color(this.id)');
			textArea_formula_updt.setAttribute('onblur','blur_change_color(this.id)');
			var Lbl_txtArea_formula_updt = CreateLABEL(update_formula_td10,'','Lbl_txtArea_formula_updt');
			Lbl_txtArea_formula_updt.style.display = 'none';
		//Hidden_field, Save_button...
		var Buttn_Tbl = CreateTable(Div_block);
		Buttn_Tbl.style.width ='100%';
		var Btn_tr1 = CreateTR(Buttn_Tbl);
			var update_HiddenField_td1 = CreateTD(Btn_tr1);
			update_HiddenField_td1.width = '50%';
			var CT_Act_hidden_field = CreateHIDDEN(update_HiddenField_td1,'','Updt_Action_id');
			Btn_tr1.innerHTML += "<td width='50%' align='right'><input type='button' id='sms_save' style='width:60px;' class='ui-widget' value='Save'  onclick='Update_Action_save()'/>&nbsp;&nbsp;<input type='button' style='margin-right:25px;width:60px;' id='sms_close' value='Close' class='ui-widget' onclick='Close_Action_dialog()' /></td>";
		//Disp_Lbl
			var Disp_Lbl_Div = CreateDIV(Div_block,'','update_Div_disp_Lbl');
			Disp_Lbl_Div.align = 'center';
			Disp_Lbl_Div.style.display = 'none';
			var update_Disp_Lbl = CreateLABEL(Disp_Lbl_Div,'DisplayLabelClass','update_Action_Disp_Lbl','Update Action Saved Successfully.');
			update_Disp_Lbl.style.width = '45%';
			update_Disp_Lbl.style.backgroundColor = '#FFDC77';

			if(IsEdtUpdtFlg == 0){
				document.getElementById('select_fld2Updt').style.display = 'none';
				var LblSelectField2Update = document.getElementById('Lbl_select_Field2update');
				LblSelectField2Update.style.display = 'inline';
				LblSelectField2Update.innerHTML = u_col_to_update;
				
				document.getElementById('txt_col2updt').style.display = 'none';
				var LblTxtCol2Updt = document.getElementById('Lbl_txt_col2updt');
				LblTxtCol2Updt.style.display = 'inline';
				LblTxtCol2Updt.innerHTML = u_col_to_upd_name;

				document.getElementById('select_Obj2updt').style.display = 'none';
				var LblSelObj2Updt = document.getElementById('Lbl_sel_Obj2updt');
				LblSelObj2Updt.style.display = 'inline';
				LblSelObj2Updt.innerHTML = u_tbl_to_update;

				document.getElementById('txt_tbl2updt').style.display = 'none';
				var LblTxtTbl2Updt = document.getElementById('Lbl_txt_tbl2Updt');
				LblTxtTbl2Updt.style.display = 'inline';
				LblTxtTbl2Updt.innerHTML = u_tbl_to_upd_name;

				document.getElementById('txtArea_formula2updt').style.display = 'none';
				var LblTxtAreaFormulaUpdt = document.getElementById('Lbl_txtArea_formula_updt');
				LblTxtAreaFormulaUpdt.style.display = 'inline';
				LblTxtAreaFormulaUpdt.innerHTML = u_formula;

				document.getElementById('sms_save').value = 'Edit';
				document.getElementById('sms_save').setAttribute("onclick","update(1)");

				document.getElementById('update_Div_disp_Lbl').style.display = 'inline';
				setTimeout("document.getElementById('update_Div_disp_Lbl').style.display='none'",2000);
			}
			else if(IsEdtUpdtFlg == 1){
				document.getElementById('select_fld2Updt').value = u_col_to_update;
				document.getElementById('txt_col2updt').value = u_col_to_upd_name;
				document.getElementById('select_Obj2updt').value = u_tbl_to_update;
				document.getElementById('txt_tbl2updt').value = u_tbl_to_upd_name;
				document.getElementById('txtArea_formula2updt').value = u_formula;
				
				document.getElementById('sms_save').value = 'Update';
				document.getElementById('sms_save').setAttribute("onclick","Update_Action_save()");
				
				document.getElementById('update_Action_Disp_Lbl').innerHTML = 'Update Action Updated Successfully.';
				document.getElementById('update_Div_disp_Lbl').style.display = 'inline';
				setTimeout("document.getElementById('update_Div_disp_Lbl').style.display='none'",2000);
			}
	}
  </script>

  <style type="text/css">
	.MandatoryClass{
		text-align:right;font-family:Tahoma, Verdana;font-size:10px;color:blue;margin-left:50%;
	}

	.DisplayLabelClass{
		font-family:Tahoma, Verdana;font-size:12px;color:red;text-align:center;
	}

	.heading_font{
		font-size:18px;font-weight:bold;font-family:Tahoma, Verdana;
	}

	.normal_font{
		font-size:12px;font-family:Tahoma, Verdana;
	}

	.RuleActionLblClass{
		color:blue;font-size:15px;width:30%;font-family:Tahoma,Verdana;margin-top:-1px;text-align:center;visibility:hidden;padding:5px 8px 8px 3px;
	}

	.td_class1{
		text-align:left;font-family:Tahoma, Verdana;font-size:12px;width:20%;
	}

	.td_class2{
		text-align:left;font-family:Tahoma, Verdana;font-size:12px;width:30%;
	}

	.ui-dialog-title{padding:5px;color:black; font-family:Tahoma,Verdana; font-size:12px; height:14px; font-weight:normal;} 

	.ui-widget{background:url("images/ui-bg_glass_75_e6e6e6_1x400.png") repeat-x scroll 50% 50% #EEEEEE}

	.ui-widget-header{
		border:1px solid #C79810; 
		background:-moz-linear-gradient(center top , #EAB92D 0%, #C79810 100%) repeat scroll 0 0 transparent;
		background:-webkit-linear-gradient(top, #EAB92D 0%, #C79810 100%);
	}

	.ahover{color:#0000FF;cursor:pointer;}
	.ahover:hover{color:#000080;text-decoration:underline;}

	.EditActionClass{color:blue;text-decoration:underline;}
	.EditActionClass:hover{cursor:pointer;}

	.TaskTrClass { background-color:#FFFFFF;height:50px;}
	.TaskTrClass:hover{background-color:#F9FBFC;}

  </style>
 </head>

 <body onload="Add_rule()">
	<div>
		<table width='90%'>
		<tr>
			<td width='50%'><label style="font-size:25px" class="heading_font">Workflow Rule</label></td>
			<td width='47%' align='right'>
			<img style="cursor:pointer;display:inline" src="/atCRM/images/help.png" alt="icon of Help"/></td>
			<td><label class="normal_font" style="cursor:pointer;">Help</label></td>
		</tr>
		</table>
		<div id='smartSuggestDiv2Task' style='display:none;position:absolute;z-index:2147483647;'></div>
		<div id='multiSelectSugg' name='multiSelectSugg' style='display: none; position: absolute; z-index: 2147483647;'></div>
		<div id='commonPickListDiv' name='commonPickListDiv' style='height: auto; width: auto; display: none;'></div>
	</div>
		<div id="accordion">
		<!-- First Accordion -->
			<div>
				<table width='100%'>
				<tr>
					<td style="font-size:20px;" width='40%'></td>
					<td><span style='display:inline;' id = 'label_disp_span'></span></td>
				</tr>
				</table>
				<div id="AddRuleDiv"></div>
			</div>
			<br/>
		 <!-- Second Accordian -->
		<div id='action_div' align='center'>
			<table width='90%'><tr><td width='80%'>
			<label style="font-size:20px;">Actions</label>
			</td><td width='20%' align='right'>
			<input type='button' style='align:right;margin:10px 10px 0px 0px;background:#EEEEEE;' onclick='dialog_model1()' value='Add New Action' id='opener' class='ui_widget'/>
			</td></tr></table>
		</div>		
		</div>
		<div id="commonPopupDiv" style="height:150px;width:625px;"></div>	
		<div id="TriggerDialog"></div>
 </body>
</html>
